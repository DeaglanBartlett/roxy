

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API &mdash; roxy 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=d45e8c67"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Tutorial" href="tutorial.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            roxy
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-regressor">regressor</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#regressor.OptResult"><code class="docutils literal notranslate"><span class="pre">OptResult</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#regressor.RoxyRegressor"><code class="docutils literal notranslate"><span class="pre">RoxyRegressor</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#regressor.RoxyRegressor.compute_information_criterion"><code class="docutils literal notranslate"><span class="pre">RoxyRegressor.compute_information_criterion()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#regressor.RoxyRegressor.find_best_gmm"><code class="docutils literal notranslate"><span class="pre">RoxyRegressor.find_best_gmm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#regressor.RoxyRegressor.get_param_index"><code class="docutils literal notranslate"><span class="pre">RoxyRegressor.get_param_index()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#regressor.RoxyRegressor.gradient"><code class="docutils literal notranslate"><span class="pre">RoxyRegressor.gradient()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#regressor.RoxyRegressor.mcmc"><code class="docutils literal notranslate"><span class="pre">RoxyRegressor.mcmc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#regressor.RoxyRegressor.mcmc2opt_index"><code class="docutils literal notranslate"><span class="pre">RoxyRegressor.mcmc2opt_index()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#regressor.RoxyRegressor.negloglike"><code class="docutils literal notranslate"><span class="pre">RoxyRegressor.negloglike()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#regressor.RoxyRegressor.optimise"><code class="docutils literal notranslate"><span class="pre">RoxyRegressor.optimise()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#regressor.RoxyRegressor.second_derivative"><code class="docutils literal notranslate"><span class="pre">RoxyRegressor.second_derivative()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#regressor.RoxyRegressor.value"><code class="docutils literal notranslate"><span class="pre">RoxyRegressor.value()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-likelihoods">likelihoods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#likelihoods.check_valid_covmat"><code class="docutils literal notranslate"><span class="pre">check_valid_covmat()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#likelihoods.likelihood_warnings"><code class="docutils literal notranslate"><span class="pre">likelihood_warnings()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#likelihoods.negloglike_gmm"><code class="docutils literal notranslate"><span class="pre">negloglike_gmm()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#likelihoods.negloglike_mnr"><code class="docutils literal notranslate"><span class="pre">negloglike_mnr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#likelihoods.negloglike_mnr_mv"><code class="docutils literal notranslate"><span class="pre">negloglike_mnr_mv()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#likelihoods.negloglike_mnr_uplims"><code class="docutils literal notranslate"><span class="pre">negloglike_mnr_uplims()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#likelihoods.negloglike_prof"><code class="docutils literal notranslate"><span class="pre">negloglike_prof()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#likelihoods.negloglike_prof_mv"><code class="docutils literal notranslate"><span class="pre">negloglike_prof_mv()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#likelihoods.negloglike_unif"><code class="docutils literal notranslate"><span class="pre">negloglike_unif()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#likelihoods.negloglike_unif_mv"><code class="docutils literal notranslate"><span class="pre">negloglike_unif_mv()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-mcmc">mcmc</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mcmc.Likelihood_GMM"><code class="docutils literal notranslate"><span class="pre">Likelihood_GMM</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mcmc.Likelihood_GMM.log_prob"><code class="docutils literal notranslate"><span class="pre">Likelihood_GMM.log_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mcmc.Likelihood_GMM.sample"><code class="docutils literal notranslate"><span class="pre">Likelihood_GMM.sample()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#mcmc.Likelihood_MNR"><code class="docutils literal notranslate"><span class="pre">Likelihood_MNR</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mcmc.Likelihood_MNR.log_prob"><code class="docutils literal notranslate"><span class="pre">Likelihood_MNR.log_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mcmc.Likelihood_MNR.sample"><code class="docutils literal notranslate"><span class="pre">Likelihood_MNR.sample()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#mcmc.Likelihood_MNR_MV"><code class="docutils literal notranslate"><span class="pre">Likelihood_MNR_MV</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mcmc.Likelihood_MNR_MV.log_prob"><code class="docutils literal notranslate"><span class="pre">Likelihood_MNR_MV.log_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mcmc.Likelihood_MNR_MV.sample"><code class="docutils literal notranslate"><span class="pre">Likelihood_MNR_MV.sample()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#mcmc.Likelihood_MNR_uplims"><code class="docutils literal notranslate"><span class="pre">Likelihood_MNR_uplims</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mcmc.Likelihood_MNR_uplims.log_prob"><code class="docutils literal notranslate"><span class="pre">Likelihood_MNR_uplims.log_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mcmc.Likelihood_MNR_uplims.sample"><code class="docutils literal notranslate"><span class="pre">Likelihood_MNR_uplims.sample()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#mcmc.Likelihood_prof"><code class="docutils literal notranslate"><span class="pre">Likelihood_prof</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mcmc.Likelihood_prof.log_prob"><code class="docutils literal notranslate"><span class="pre">Likelihood_prof.log_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mcmc.Likelihood_prof.sample"><code class="docutils literal notranslate"><span class="pre">Likelihood_prof.sample()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#mcmc.Likelihood_prof_MV"><code class="docutils literal notranslate"><span class="pre">Likelihood_prof_MV</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mcmc.Likelihood_prof_MV.log_prob"><code class="docutils literal notranslate"><span class="pre">Likelihood_prof_MV.log_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mcmc.Likelihood_prof_MV.sample"><code class="docutils literal notranslate"><span class="pre">Likelihood_prof_MV.sample()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#mcmc.Likelihood_unif"><code class="docutils literal notranslate"><span class="pre">Likelihood_unif</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mcmc.Likelihood_unif.log_prob"><code class="docutils literal notranslate"><span class="pre">Likelihood_unif.log_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mcmc.Likelihood_unif.sample"><code class="docutils literal notranslate"><span class="pre">Likelihood_unif.sample()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#mcmc.Likelihood_unif_MV"><code class="docutils literal notranslate"><span class="pre">Likelihood_unif_MV</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mcmc.Likelihood_unif_MV.log_prob"><code class="docutils literal notranslate"><span class="pre">Likelihood_unif_MV.log_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mcmc.Likelihood_unif_MV.sample"><code class="docutils literal notranslate"><span class="pre">Likelihood_unif_MV.sample()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#mcmc.OrderedNormal"><code class="docutils literal notranslate"><span class="pre">OrderedNormal</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mcmc.OrderedNormal.arg_constraints"><code class="docutils literal notranslate"><span class="pre">OrderedNormal.arg_constraints</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mcmc.OrderedNormal.cdf"><code class="docutils literal notranslate"><span class="pre">OrderedNormal.cdf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mcmc.OrderedNormal.icdf"><code class="docutils literal notranslate"><span class="pre">OrderedNormal.icdf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mcmc.OrderedNormal.log_cdf"><code class="docutils literal notranslate"><span class="pre">OrderedNormal.log_cdf()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mcmc.OrderedNormal.log_prob"><code class="docutils literal notranslate"><span class="pre">OrderedNormal.log_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mcmc.OrderedNormal.mean"><code class="docutils literal notranslate"><span class="pre">OrderedNormal.mean</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mcmc.OrderedNormal.reparametrized_params"><code class="docutils literal notranslate"><span class="pre">OrderedNormal.reparametrized_params</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mcmc.OrderedNormal.sample"><code class="docutils literal notranslate"><span class="pre">OrderedNormal.sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mcmc.OrderedNormal.support"><code class="docutils literal notranslate"><span class="pre">OrderedNormal.support</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#mcmc.OrderedNormal.variance"><code class="docutils literal notranslate"><span class="pre">OrderedNormal.variance</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#mcmc.compute_bias"><code class="docutils literal notranslate"><span class="pre">compute_bias()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#mcmc.samples_to_array"><code class="docutils literal notranslate"><span class="pre">samples_to_array()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-plotting">plotting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#plotting.posterior_predictive_plot"><code class="docutils literal notranslate"><span class="pre">posterior_predictive_plot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#plotting.trace_plot"><code class="docutils literal notranslate"><span class="pre">trace_plot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#plotting.triangle_plot"><code class="docutils literal notranslate"><span class="pre">triangle_plot()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-causality">causality</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#causality.assess_causality"><code class="docutils literal notranslate"><span class="pre">assess_causality()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#causality.compute_hsic"><code class="docutils literal notranslate"><span class="pre">compute_hsic()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">roxy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">API</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="toctree-wrapper compound">
</div>
<section id="api">
<h1>API<a class="headerlink" href="#api" title="Link to this heading"></a></h1>
<section id="module-regressor">
<span id="regressor"></span><h2>regressor<a class="headerlink" href="#module-regressor" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="regressor.OptResult">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">regressor.</span></span><span class="sig-name descname"><span class="pre">OptResult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">res</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/regressor.html#OptResult"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#regressor.OptResult" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class to make the output of a jaxopt optimisation appear like
a scipy.optimize._optimize.OptimizeResult</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">res (ScipyMinimizeInfo)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The result of a jaxopt minimisation</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="regressor.RoxyRegressor">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">regressor.</span></span><span class="sig-name descname"><span class="pre">RoxyRegressor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fun</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_default</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_prior</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/regressor.html#RoxyRegressor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#regressor.RoxyRegressor" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Regressor class which handles optimisation and MCMC for <code class="docutils literal notranslate"><span class="pre">roxy</span></code>. One can
use this class to evaluate the function of interest and its derivative,
optimise the parameters using and of the defined likelihoods and run an
MCMC for these parameters.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">fun (callable)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The function, f, to be considered by this regressor
y = f(x, theta). The function must take two arguments, the first of which
is the independent variable, the second of which are the parameters (as an
array or list).</p>
</dd>
<dt class="field-even">param_names (list)<span class="colon">:</span></dt>
<dd class="field-even"><p>The list of parameter names, in the order which they are
supplied to fun</p>
</dd>
<dt class="field-odd">param_default (list)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The default valus of the parameters</p>
</dd>
<dt class="field-even">param_prior (dict)<span class="colon">:</span></dt>
<dd class="field-even"><p>The prior range for each of the parameters. The prior is
assumed to be uniform in this range. If either entry is None in the prior,
then an infinite uniform prior is assumed.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="regressor.RoxyRegressor.compute_information_criterion">
<span class="sig-name descname"><span class="pre">compute_information_criterion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">criterion</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params_to_opt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngauss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infer_intrinsic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress_bar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwarm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mnr'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gmm_prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hierarchical'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1234</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_logdet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimiser</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'l-bfgs-b'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/regressor.html#RoxyRegressor.compute_information_criterion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#regressor.RoxyRegressor.compute_information_criterion" title="Link to this definition"></a></dt>
<dd><p>Compute an information criterion for a given setup
If an initial guess is not given, we first run a MCMC
to get an initial guess for the maximum likelihood
point, and we then an optimsier from this point to get a better
estimate for this. Since we do not need good MCMC convergence for this,
small values of nwarm and nsamp can be used.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">criterion (str)<span class="colon">:</span></dt>
<dd class="field-odd"><p>Which information criterion to use (supported: AIC and
BIC)</p>
</dd>
<dt class="field-even">params_to_opt (list)<span class="colon">:</span></dt>
<dd class="field-even"><p>The names of the parameters we wish to optimise</p>
</dd>
<dt class="field-odd">xobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The observed x values</p>
</dd>
<dt class="field-even">yobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The observed y values</p>
</dd>
<dt class="field-odd">errors (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>[xerr, yerr], giving the error on the observed
x and y values</p>
</dd>
<dt class="field-even">ngauss (int, default = 1)<span class="colon">:</span></dt>
<dd class="field-even"><p>The number of Gaussians to use in the GMM
prior. Only used if method=’gmm’</p>
</dd>
<dt class="field-odd">infer_intrinsic (bool, default=True)<span class="colon">:</span></dt>
<dd class="field-odd"><p>Whether to infer the intrinsic
scatter in the y direction</p>
</dd>
<dt class="field-even">initial (jnp.ndarray, default=None)<span class="colon">:</span></dt>
<dd class="field-even"><p>The starting point for the optimised.
If None, a MCMC is run.</p>
</dd>
<dt class="field-odd">progress_bar (bool, default=True)<span class="colon">:</span></dt>
<dd class="field-odd"><p>Whether to display a progress bar for
the MCMC</p>
</dd>
<dt class="field-even">nwarm (int, default=100)<span class="colon">:</span></dt>
<dd class="field-even"><p>The number of warmup steps to use in the MCMC</p>
</dd>
<dt class="field-odd">nsamp (int, default=100)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of samples to obtain in the MCMC</p>
</dd>
<dt class="field-even">method (str, default=’mnr’)<span class="colon">:</span></dt>
<dd class="field-even"><p>The name of the likelihood method to use
(‘mnr’, ‘gmm’, ‘unif’ or ‘prof’). See <code class="docutils literal notranslate"><span class="pre">roxy.likelihoods</span></code> for more
information.</p>
</dd>
<dt class="field-odd">gmm_prior (string, default=’hierarchical’)<span class="colon">:</span></dt>
<dd class="field-odd"><p>If method=’gmm’, this decides
what prior to put on the GMM componenents. If ‘uniform’, then the mean
and widths have a uniform prior, and if ‘hierarchical’ mu and w^2 have
a Normal and Inverse Gamma prior, respectively.</p>
</dd>
<dt class="field-even">seed (int, default=1234)<span class="colon">:</span></dt>
<dd class="field-even"><p>The seed to use when initialising the sampler</p>
</dd>
<dt class="field-odd">verbose (bool, default=True)<span class="colon">:</span></dt>
<dd class="field-odd"><p>Whether to print progress or not</p>
</dd>
<dt class="field-even">include_logdet (bool, default=True)<span class="colon">:</span></dt>
<dd class="field-even"><p>For the method ‘prof’, whether to
include the normalisation term in the likelihood proportional
to log(det(S))</p>
</dd>
<dt class="field-odd">optimiser (str, default=’l-bfgs-b’)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The optimiser to use. This must be a
method supported by jaxopt.ScipyBoundedMinimize.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="field-list simple">
<dt class="field-odd">negloglike (float)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The optimum negative log-likelihood value</p>
</dd>
<dt class="field-even">metric (float)<span class="colon">:</span></dt>
<dd class="field-even"><p>The value of the information criterion</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="regressor.RoxyRegressor.find_best_gmm">
<span class="sig-name descname"><span class="pre">find_best_gmm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params_to_opt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_ngauss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BIC'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infer_intrinsic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress_bar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwarm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gmm_prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hierarchical'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1234</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_logdet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/regressor.html#RoxyRegressor.find_best_gmm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#regressor.RoxyRegressor.find_best_gmm" title="Link to this definition"></a></dt>
<dd><p>Find the number of Gaussians to use in a Gaussian Mixture Model
hyper-prior on the true x values, accoridng to some metric.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">params_to_opt (list)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The names of the parameters we wish to optimise</p>
</dd>
<dt class="field-even">xobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The observed x values</p>
</dd>
<dt class="field-odd">yobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The observed y values</p>
</dd>
<dt class="field-even">xerr (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The error on the observed x values</p>
</dd>
<dt class="field-odd">yerr (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The error on the observed y values</p>
</dd>
<dt class="field-even">max_ngauss (int)<span class="colon">:</span></dt>
<dd class="field-even"><p>The maximum number of Gaussians to consider</p>
</dd>
<dt class="field-odd">best_metric (str)<span class="colon">:</span></dt>
<dd class="field-odd"><p>Metric to use to compare fits (supported: AIC and BIC)</p>
</dd>
<dt class="field-even">infer_intrinsic (bool, default=True)<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether to infer the intrinsic
scatter in the y direction</p>
</dd>
<dt class="field-odd">progress_bar (bool, default=True)<span class="colon">:</span></dt>
<dd class="field-odd"><p>Whether to display a progress bar for
the MCMC</p>
</dd>
<dt class="field-even">nwarm (int, default=100)<span class="colon">:</span></dt>
<dd class="field-even"><p>The number of warmup steps to use in the MCMC</p>
</dd>
<dt class="field-odd">nsamp (int, default=100)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of samples to obtain in the MCMC</p>
</dd>
<dt class="field-even">gmm_prior (string, default=’hierarchical’)<span class="colon">:</span></dt>
<dd class="field-even"><p>If method=’gmm’, this decides
what prior to put on the GMM componenents. If ‘uniform’, then the mean
and widths have a uniform prior, and if ‘hierarchical’ mu and w^2 have
a Normal and Inverse Gamma prior, respectively.</p>
</dd>
<dt class="field-odd">seed (int, default=1234)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The seed to use when initialising the sampler</p>
</dd>
<dt class="field-even">verbose (bool, default=True)<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether to print progress or not</p>
</dd>
<dt class="field-odd">include_logdet (bool, default=True)<span class="colon">:</span></dt>
<dd class="field-odd"><p>For the method ‘prof’, whether to
include the normalisation term in the likelihood proportional
to log(det(S))</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="field-list simple">
<dt class="field-odd">ngauss (int)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The best number of Gaussians to use according to the metric</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="regressor.RoxyRegressor.get_param_index">
<span class="sig-name descname"><span class="pre">get_param_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params_to_opt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/regressor.html#RoxyRegressor.get_param_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#regressor.RoxyRegressor.get_param_index" title="Link to this definition"></a></dt>
<dd><p>If the function of interest if f(x, theta), find the index in theta for each
of the parameters we wish to optimise</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">params_to_opt (list)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The names of the parameters we wish to optimise</p>
</dd>
<dt class="field-even">verbose (bool, default=True)<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether to print the names and values of
parameters which are not fitted</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="field-list simple">
<dt class="field-odd">pidx (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The indices of the parameters to optimise</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="regressor.RoxyRegressor.gradient">
<span class="sig-name descname"><span class="pre">gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/regressor.html#RoxyRegressor.gradient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#regressor.RoxyRegressor.gradient" title="Link to this definition"></a></dt>
<dd><p>If we are fitting the function f(x, theta), this is df/dx evaluated at
(x, theta)</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">x (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The x values</p>
</dd>
<dt class="field-even">theta (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The parameter values</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="field-list simple">
<dt class="field-odd">jnp.ndarray<span class="colon">:</span></dt>
<dd class="field-odd"><p>df/dx evaluated at (x, theta)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="regressor.RoxyRegressor.mcmc">
<span class="sig-name descname"><span class="pre">mcmc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params_to_opt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwarm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_is_detected</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mnr'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngauss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infer_intrinsic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_chains</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress_bar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covmat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gmm_prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hierarchical'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1234</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_logdet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimiser</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'l-bfgs-b'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/regressor.html#RoxyRegressor.mcmc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#regressor.RoxyRegressor.mcmc" title="Link to this definition"></a></dt>
<dd><p>Run an MCMC using the NUTS sampler of <code class="docutils literal notranslate"><span class="pre">numpyro</span></code> for the parameters of the
function given some data, under the assumption of an uncorrelated Gaussian
likelihood, using the likelihood specififed by ‘method’.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">params_to_opt (list)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The names of the parameters we wish to optimise</p>
</dd>
<dt class="field-even">xobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The observed x values</p>
</dd>
<dt class="field-odd">yobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The observed y values</p>
</dd>
<dt class="field-even">errors (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>If covmat=False, then this is [xerr, yerr], giving
the error on the observed x and y values. Otherwise, this is the
covariance matrix in the order (x, y)</p>
</dd>
<dt class="field-odd">nwarm (int)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of warmup steps to use in the MCMC</p>
</dd>
<dt class="field-even">nsamp (int)<span class="colon">:</span></dt>
<dd class="field-even"><p>The number of samples to obtain in the MCMC</p>
</dd>
<dt class="field-odd">y_is_detected (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>A boolean array of the same length as xobs 
and yobs, giving whether each point is a detection (True) or an upper 
limit (False).</p>
</dd>
<dt class="field-even">method (str, default=’mnr’)<span class="colon">:</span></dt>
<dd class="field-even"><p>The name of the likelihood method to use
(‘mnr’, ‘gmm’, ‘unif’ or ‘prof’). See <code class="docutils literal notranslate"><span class="pre">roxy.likelihoods</span></code> for more
information.</p>
</dd>
<dt class="field-odd">ngauss (int, default = 1)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of Gaussians to use in the GMM prior.
Only used if method=’gmm’</p>
</dd>
<dt class="field-even">infer_intrinsic (bool, default=True)<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether to infer the intrinsic
scatter in the y direction</p>
</dd>
<dt class="field-odd">num_chains (int, default=1)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of independent MCMC chains to run</p>
</dd>
<dt class="field-even">progress_bar (bool, default=True)<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether to display a progress bar for
the MCMC</p>
</dd>
<dt class="field-odd">covmat (bool, default=False)<span class="colon">:</span></dt>
<dd class="field-odd"><p>This determines whether the errors argument
is [xerr, yerr] (False) or a covariance matrix (True).</p>
</dd>
<dt class="field-even">gmm_prior (string, default=’hierarchical’)<span class="colon">:</span></dt>
<dd class="field-even"><p>If method=’gmm’, this decides
what prior to put on the GMM componenents. If ‘uniform’, then the mean
and widths have a uniform prior, and if ‘hierarchical’ mu and w^2 have a
Normal and Inverse Gamma prior, respectively.</p>
</dd>
<dt class="field-odd">seed (int, default=1234)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The seed to use when initialising the sampler</p>
</dd>
<dt class="field-even">verbose (bool, default=True)<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether to print progress or not</p>
</dd>
<dt class="field-odd">init (dict, default=None)<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dictionary of values of initialise the MCMC at</p>
</dd>
<dt class="field-even">include_logdet (bool, default=True)<span class="colon">:</span></dt>
<dd class="field-even"><p>For the method ‘prof’, whether to
include the normalisation term in the likelihood proportional
to log(det(S))</p>
</dd>
<dt class="field-odd">optimiser (str, default=’l-bfgs-b’)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The optimiser to use if a initial
point is not specified. This must be a method supported by
jaxopt.ScipyBoundedMinimize.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="field-list simple">
<dt class="field-odd">samples (dict)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The MCMC samples, where the keys are the parameter names
and values are ndarrays of the samples</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="regressor.RoxyRegressor.mcmc2opt_index">
<span class="sig-name descname"><span class="pre">mcmc2opt_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngauss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mnr'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gmm_prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hierarchical'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infer_intrinsic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/regressor.html#RoxyRegressor.mcmc2opt_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#regressor.RoxyRegressor.mcmc2opt_index" title="Link to this definition"></a></dt>
<dd><p>Find the indices which convert the samples produced by the MCMC to the order
required for the optimiser</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">labels (list)<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of label names in the order produced by the MCMC</p>
</dd>
<dt class="field-even">ngauss (int, default = 1)<span class="colon">:</span></dt>
<dd class="field-even"><p>The number of Gaussians to use in the GMM prior.
Only used if method=’gmm’</p>
</dd>
<dt class="field-odd">method (str, default=’mnr’)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The name of the likelihood method to use
(‘mnr’, ‘gmm’, ‘unif’ or ‘prof’). See <code class="docutils literal notranslate"><span class="pre">roxy.likelihoods</span></code> for more
information.</p>
</dd>
<dt class="field-even">gmm_prior (string, default=’hierarchical’)<span class="colon">:</span></dt>
<dd class="field-even"><p>If method=’gmm’, this decides
what prior to put on the GMM componenents. If ‘uniform’, then the mean
and widths have a uniform prior, and if ‘hierarchical’ mu and w^2 have
a Normal and Inverse Gamma prior, respectively.</p>
</dd>
<dt class="field-odd">infer_intrinsic (bool, default=True)<span class="colon">:</span></dt>
<dd class="field-odd"><p>Whether to infer the intrinsic
scatter in the y direction</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="field-list simple">
<dt class="field-odd">param_idx (list)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The indices which convert the order of parameters from
the MCMC to that expected by the optimiser</p>
</dd>
<dt class="field-even">param_names (list)<span class="colon">:</span></dt>
<dd class="field-even"><p>The names of the parameters in the order expected by
the optimiser</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="regressor.RoxyRegressor.negloglike">
<span class="sig-name descname"><span class="pre">negloglike</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_is_detected</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_gauss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_gauss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights_gauss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mnr'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covmat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_logdet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/regressor.html#RoxyRegressor.negloglike"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#regressor.RoxyRegressor.negloglike" title="Link to this definition"></a></dt>
<dd><p>Computes the negative log-likelihood under the assumption of
an uncorrelated (correlated) Gaussian likelihood if covmat is False (True),
using the likelihood specififed by ‘method’.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">theta (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The parameters of the function to use</p>
</dd>
<dt class="field-even">xobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The observed x values</p>
</dd>
<dt class="field-odd">yobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The observed y values</p>
</dd>
<dt class="field-even">errors (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>If covmat=False, then this is [xerr, yerr], giving
the error on the observed x and y values. Otherwise, this is the
covariance matrix in the order (x, y)</p>
</dd>
<dt class="field-odd">y_is_detected (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>A boolean array of the same length as xobs 
and yobs, giving whether each point is a detection (True) or an upper 
limit (False)</p>
</dd>
<dt class="field-even">sig (float, default=0.)<span class="colon">:</span></dt>
<dd class="field-even"><p>The intrinsic scatter, which is added in
quadrature with yerr</p>
</dd>
<dt class="field-odd">mu_gauss (float or jnp.ndarray, default=0.)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The mean of the Gaussian
prior on the true x positions (only used if method=’mnr’ or ‘gmm’).
If using ‘mnr’ and this is an array, only the first mean is used.</p>
</dd>
<dt class="field-even">w_gauss (float or jnp.ndarray, default=1.)<span class="colon">:</span></dt>
<dd class="field-even"><p>The standard deviation of the
Gaussian prior on the true x positions (only used if method=’mnr’).</p>
</dd>
<dt class="field-odd">weights_gauss (float or jnp.ndarray, default=1.)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The weights of the
Gaussians in a GMM prior on the true x positions (only used if
method=’gmm’).</p>
</dd>
<dt class="field-even">method (str, default=’mnr’)<span class="colon">:</span></dt>
<dd class="field-even"><p>The name of the likelihood method to use
(‘mnr’, ‘gmm’, ‘unif’ or ‘prof’). See <code class="docutils literal notranslate"><span class="pre">roxy.likelihoods</span></code> for more
information</p>
</dd>
<dt class="field-odd">covmat (bool, default=False)<span class="colon">:</span></dt>
<dd class="field-odd"><p>This determines whether the errors argument
is [xerr, yerr] (False) or a covariance matrix (True).</p>
</dd>
<dt class="field-even">test_prior (bool, default=True)<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether to test sigma &gt;= 0 and Gaussians
weights &gt;= 0</p>
</dd>
<dt class="field-odd">include_logdet (bool, default=True)<span class="colon">:</span></dt>
<dd class="field-odd"><p>For the method ‘prof’, whether to
include the normalisation term in the likelihood proportional
to log(det(S))</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="regressor.RoxyRegressor.optimise">
<span class="sig-name descname"><span class="pre">optimise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params_to_opt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_is_detected</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mnr'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infer_intrinsic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngauss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covmat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gmm_prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hierarchical'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_logdet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimiser</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'l-bfgs-b'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/regressor.html#RoxyRegressor.optimise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#regressor.RoxyRegressor.optimise" title="Link to this definition"></a></dt>
<dd><p>Optimise the parameters of the function given some data, under the assumption of
an uncorrelated (correlated) Gaussian likelihood if covmat is False (True),
using the likelihood specififed by ‘method’.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">params_to_opt (list)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The names of the parameters we wish to optimise</p>
</dd>
<dt class="field-even">xobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The observed x values</p>
</dd>
<dt class="field-odd">yobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The observed y values</p>
</dd>
<dt class="field-even">errors (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>If covmat=False, then this is [xerr, yerr], giving
the error on the observed x and y values. Otherwise, this is the
covariance matrix in the order (x, y)</p>
</dd>
<dt class="field-odd">y_is_detected (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>A boolean array of the same length as xobs 
and yobs, giving whether each point is a detection (True) or an upper 
limit (False)</p>
</dd>
<dt class="field-even">method (str, default=’mnr’)<span class="colon">:</span></dt>
<dd class="field-even"><p>The name of the likelihood method to use
(‘mnr’, ‘gmm’, ‘unif’ or ‘prof’). See <code class="docutils literal notranslate"><span class="pre">roxy.likelihoods</span></code> for more
information</p>
</dd>
<dt class="field-odd">infer_intrinsic (bool, default=True)<span class="colon">:</span></dt>
<dd class="field-odd"><p>Whether to infer the intrinsic
scatter in the y direction</p>
</dd>
<dt class="field-even">initial (jnp.ndarray, default=None)<span class="colon">:</span></dt>
<dd class="field-even"><p>The starting point for the optimised.
If None, a random value in the prior range is chosen</p>
</dd>
<dt class="field-odd">ngauss (int, default = 1)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of Gaussians to use in the GMM prior.
Only used if method=’gmm’</p>
</dd>
<dt class="field-even">covmat (bool, default=False)<span class="colon">:</span></dt>
<dd class="field-even"><p>This determines whether the errors argument
is [xerr, yerr] (False) or a covariance matrix (True).</p>
</dd>
<dt class="field-odd">gmm_prior (string, default=’hierarchical’)<span class="colon">:</span></dt>
<dd class="field-odd"><p>If method=’gmm’, this decides
what prior to put on the GMM componenents. If ‘uniform’, then the mean
and widths have a uniform prior, and if ‘hierarchical’ mu and w^2 have
a Normal and Inverse Gamma prior, respectively.</p>
</dd>
<dt class="field-even">include_logdet (bool, default=True)<span class="colon">:</span></dt>
<dd class="field-even"><p>For the method ‘prof’, whether to
include the normalisation term in the likelihood proportional
to log(det(S))</p>
</dd>
<dt class="field-odd">verbose (bool, default=True)<span class="colon">:</span></dt>
<dd class="field-odd"><p>Whether to print progress or not</p>
</dd>
<dt class="field-even">optimiser (str, default=’l-bfgs-b’)<span class="colon">:</span></dt>
<dd class="field-even"><p>The optimiser to use. This must be a
method supported by jaxopt.ScipyBoundedMinimize.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="field-list simple">
<dt class="field-odd">res (OptResult)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The result of the optimisation</p>
</dd>
<dt class="field-even">param_names (list)<span class="colon">:</span></dt>
<dd class="field-even"><p>List of parameter names in order of res.params</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="regressor.RoxyRegressor.second_derivative">
<span class="sig-name descname"><span class="pre">second_derivative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/regressor.html#RoxyRegressor.second_derivative"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#regressor.RoxyRegressor.second_derivative" title="Link to this definition"></a></dt>
<dd><p>If we are fitting the function f(x, theta), this is d^2f/dx^2 evaluated at
(x, theta)</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">x (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The x values</p>
</dd>
<dt class="field-even">theta (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The parameter values</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="field-list simple">
<dt class="field-odd">jnp.ndarray<span class="colon">:</span></dt>
<dd class="field-odd"><p>d^2f/dx^2 evaluated at (x, theta)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="regressor.RoxyRegressor.value">
<span class="sig-name descname"><span class="pre">value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/regressor.html#RoxyRegressor.value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#regressor.RoxyRegressor.value" title="Link to this definition"></a></dt>
<dd><p>If we are fitting the function f(x, theta), this is f(x, theta) evaluated at
(x, theta)</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">x (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The x values</p>
</dd>
<dt class="field-even">theta (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The parameter values</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="field-list simple">
<dt class="field-odd">jnp.ndarray<span class="colon">:</span></dt>
<dd class="field-odd"><p>f(x, theta) evaluated at (x, theta)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-likelihoods">
<span id="likelihoods"></span><h2>likelihoods<a class="headerlink" href="#module-likelihoods" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="likelihoods.check_valid_covmat">
<span class="sig-prename descclassname"><span class="pre">likelihoods.</span></span><span class="sig-name descname"><span class="pre">check_valid_covmat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">D</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/likelihoods.html#check_valid_covmat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#likelihoods.check_valid_covmat" title="Link to this definition"></a></dt>
<dd><p>Check if a covariance matrix is valid (symmetric and positive semi-definite)
- Symmetry (within tolerance)
- Positive semi-definiteness (eigvals &gt;= -tol)</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">D (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The covariance matrix to check</p>
</dd>
<dt class="field-even">tol (float, default=1e-8)<span class="colon">:</span></dt>
<dd class="field-even"><p>The tolerance for numerical checks</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="field-list simple">
<dt class="field-odd">is_valid (bool)<span class="colon">:</span></dt>
<dd class="field-odd"><p>Whether the covariance matrix is valid</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="likelihoods.likelihood_warnings">
<span class="sig-prename descclassname"><span class="pre">likelihoods.</span></span><span class="sig-name descname"><span class="pre">likelihood_warnings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infer_intrinsic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covmat</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/likelihoods.html#likelihood_warnings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#likelihoods.likelihood_warnings" title="Link to this definition"></a></dt>
<dd><p>Raise warnings if using asymptotically biased likelihood
for the situation of interest.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">method (str, default=’mnr’)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The name of the likelihood method to use
(‘mnr’, ‘gmm’, ‘unif’ or ‘prof’).</p>
</dd>
<dt class="field-even">infer_intrinsic (bool, default=True)<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether to infer the intrinsic
scatter in the y direction</p>
</dd>
<dt class="field-odd">nx (int)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of observed x values</p>
</dd>
<dt class="field-even">errors (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>If covmat=False, then this is [xerr, yerr], giving
the error on the observed x and y values. Otherwise, this is the
covariance matrix in the order (x, y)</p>
</dd>
<dt class="field-odd">covmat (bool, default=False)<span class="colon">:</span></dt>
<dd class="field-odd"><p>This determines whether the errors argument
is [xerr, yerr] (False) or a covariance matrix (True).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="likelihoods.negloglike_gmm">
<span class="sig-prename descclassname"><span class="pre">likelihoods.</span></span><span class="sig-name descname"><span class="pre">negloglike_gmm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fprime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_mu_gauss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_w_gauss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_weights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/likelihoods.html#negloglike_gmm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#likelihoods.negloglike_gmm" title="Link to this definition"></a></dt>
<dd><p>Computes the negative log-likelihood under the assumption of an uncorrelated
Gaussian likelihood with a GMM prior on the true x positions.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">xobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The observed x values</p>
</dd>
<dt class="field-even">yobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The observed y values</p>
</dd>
<dt class="field-odd">xerr (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The error on the observed x values</p>
</dd>
<dt class="field-even">yerr (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The error on the observed y values</p>
</dd>
<dt class="field-odd">f (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>If we are fitting the function f(x), this is f(x) evaluated
at xobs</p>
</dd>
<dt class="field-even">fprime (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>If we are fitting the function f(x), this is df/dx
evaluated at xobs</p>
</dd>
<dt class="field-odd">sig (float)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The intrinsic scatter, which is added in quadrature with yerr</p>
</dd>
<dt class="field-even">all_mu_gauss (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The means of the Gaussians in the GMM prior on
the true x positions</p>
</dd>
<dt class="field-odd">all_w_gauss (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The standard deviations of the Gaussians in the GMM
prior on the true x positions</p>
</dd>
<dt class="field-even">all_weights (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The weights of the Gaussians in the GMM prior on the
true x positions</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="field-list simple">
<dt class="field-odd">neglogP (float)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The negative log-likelihood</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="likelihoods.negloglike_mnr">
<span class="sig-prename descclassname"><span class="pre">likelihoods.</span></span><span class="sig-name descname"><span class="pre">negloglike_mnr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fprime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_gauss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_gauss</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/likelihoods.html#negloglike_mnr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#likelihoods.negloglike_mnr" title="Link to this definition"></a></dt>
<dd><p>Computes the negative log-likelihood under the assumption of an uncorrelated
Gaussian likelihood with a Gaussian prior on the true x positions.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">xobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The observed x values</p>
</dd>
<dt class="field-even">yobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The observed y values</p>
</dd>
<dt class="field-odd">xerr (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The error on the observed x values</p>
</dd>
<dt class="field-even">yerr (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The error on the observed y values</p>
</dd>
<dt class="field-odd">f (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>If we are fitting the function f(x), this is f(x) evaluated
at xobs</p>
</dd>
<dt class="field-even">fprime (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>If we are fitting the function f(x), this is df/dx
evaluated at xobs</p>
</dd>
<dt class="field-odd">sig (float)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The intrinsic scatter, which is added in quadrature with yerr</p>
</dd>
<dt class="field-even">mu_gauss (float)<span class="colon">:</span></dt>
<dd class="field-even"><p>The mean of the Gaussian prior on the true x positions</p>
</dd>
<dt class="field-odd">w_gauss (float)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The standard deviation of the Gaussian prior on the true x
positions</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="field-list simple">
<dt class="field-odd">neglogP (float)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The negative log-likelihood</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="likelihoods.negloglike_mnr_mv">
<span class="sig-prename descclassname"><span class="pre">likelihoods.</span></span><span class="sig-name descname"><span class="pre">negloglike_mnr_mv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_gauss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_gauss</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/likelihoods.html#negloglike_mnr_mv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#likelihoods.negloglike_mnr_mv" title="Link to this definition"></a></dt>
<dd><p>Computes the negative log-likelihood under the assumption of a correlated
Gaussian likelihood (i.e. arbitrary covariance matrix) with a Gaussian prior
on the true x positions.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">xobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The observed x values</p>
</dd>
<dt class="field-even">yobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The observed y values</p>
</dd>
<dt class="field-odd">Sigma (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The covariance matrix giving the errors on the observed
(x, y) values</p>
</dd>
<dt class="field-even">f (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>If we are fitting the function f(x), this is f(x) evaluated at
xobs</p>
</dd>
<dt class="field-odd">G (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>If we are fitting the function f(x), this is
G_{ij} = df_i/dx_j evaluated at xobs</p>
</dd>
<dt class="field-even">sig (float)<span class="colon">:</span></dt>
<dd class="field-even"><p>The intrinsic scatter, which is added in quadrature with yerr</p>
</dd>
<dt class="field-odd">mu_gauss (float)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The mean of the Gaussian prior on the true x positions</p>
</dd>
<dt class="field-even">w_gauss (float)<span class="colon">:</span></dt>
<dd class="field-even"><p>The standard deviation of the Gaussian prior on the true x
positions</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="field-list simple">
<dt class="field-odd">neglogP (float)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The negative log-likelihood</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="likelihoods.negloglike_mnr_uplims">
<span class="sig-prename descclassname"><span class="pre">likelihoods.</span></span><span class="sig-name descname"><span class="pre">negloglike_mnr_uplims</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_is_detected</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fprime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_gauss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_gauss</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/likelihoods.html#negloglike_mnr_uplims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#likelihoods.negloglike_mnr_uplims" title="Link to this definition"></a></dt>
<dd><p>Computes the negative log-likelihood under the assumption of an uncorrelated
Gaussian likelihood with a Gaussian prior on the true x positions,</p>
<blockquote>
<div><p>where some of the y values are upper limits.</p>
</div></blockquote>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">xobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The observed x values</p>
</dd>
<dt class="field-even">yobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The observed y values</p>
</dd>
<dt class="field-odd">y_is_detected (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>A boolean array of the same length as xobs and 
yobs, giving whether each point is a detection (True) or an upper limit (False)</p>
</dd>
<dt class="field-even">xerr (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The error on the observed x values</p>
</dd>
<dt class="field-odd">yerr (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The error on the observed y values</p>
</dd>
<dt class="field-even">f (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>If we are fitting the function f(x), this is f(x) evaluated 
at xobs</p>
</dd>
<dt class="field-odd">fprime (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>If we are fitting the function f(x), this is df/dx 
evaluated at xobs</p>
</dd>
<dt class="field-even">sig (float)<span class="colon">:</span></dt>
<dd class="field-even"><p>The intrinsic scatter, which is added in quadrature with yerr</p>
</dd>
<dt class="field-odd">mu_gauss (float)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The mean of the Gaussian prior on the true x positions</p>
</dd>
<dt class="field-even">w_gauss (float)<span class="colon">:</span></dt>
<dd class="field-even"><p>The standard deviation of the Gaussian prior on the true x 
positions</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="likelihoods.negloglike_prof">
<span class="sig-prename descclassname"><span class="pre">likelihoods.</span></span><span class="sig-name descname"><span class="pre">negloglike_prof</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fprime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_logdet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/likelihoods.html#negloglike_prof"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#likelihoods.negloglike_prof" title="Link to this definition"></a></dt>
<dd><p>Computes the negative log-likelihood under the assumption of an uncorrelated
Gaussian likelihood, evaluated at the maximum likelihood values of xtrue
(the profile likelihood)</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">xobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The observed x values</p>
</dd>
<dt class="field-even">yobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The observed y values</p>
</dd>
<dt class="field-odd">xerr (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The error on the observed x values</p>
</dd>
<dt class="field-even">yerr (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The error on the observed y values</p>
</dd>
<dt class="field-odd">f (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>If we are fitting the function f(x), this is f(x) evaluated at
xobs</p>
</dd>
<dt class="field-even">fprime (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>If we are fitting the function f(x), this is df/dx
evaluated at xobs</p>
</dd>
<dt class="field-odd">sig (float)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The intrinsic scatter, which is added in quadrature with yerr</p>
</dd>
<dt class="field-even">include_logdet (bool, default=True)<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether to include the normalisation term
in the likelihood proportional to log(det(S))</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="field-list simple">
<dt class="field-odd">neglogP (float)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The negative log-likelihood</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="likelihoods.negloglike_prof_mv">
<span class="sig-prename descclassname"><span class="pre">likelihoods.</span></span><span class="sig-name descname"><span class="pre">negloglike_prof_mv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_logdet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/likelihoods.html#negloglike_prof_mv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#likelihoods.negloglike_prof_mv" title="Link to this definition"></a></dt>
<dd><p>Computes the negative log-likelihood under the assumption of a correlated
Gaussian likelihood (i.e. arbitrary covariance matrix), evaluated at the
maximum likelihood values of xtrue (the profile likelihood)</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">xobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The observed x values</p>
</dd>
<dt class="field-even">yobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The observed y values</p>
</dd>
<dt class="field-odd">Sigma (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The covariance matrix giving the errors on the observed
(x, y) values</p>
</dd>
<dt class="field-even">f (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>If we are fitting the function f(x), this is f(x) evaluated at
xobs</p>
</dd>
<dt class="field-odd">G (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>If we are fitting the function f(x), this is
G_{ij} = df_i/dx_j evaluated at xobs</p>
</dd>
<dt class="field-even">sig (float)<span class="colon">:</span></dt>
<dd class="field-even"><p>The intrinsic scatter, which is added in quadrature with yerr</p>
</dd>
<dt class="field-odd">include_logdet (bool, default=True)<span class="colon">:</span></dt>
<dd class="field-odd"><p>Whether to include the normalisation term
in the likelihood proportional to log(det(S))</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="field-list simple">
<dt class="field-odd">neglogP (float)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The negative log-likelihood</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="likelihoods.negloglike_unif">
<span class="sig-prename descclassname"><span class="pre">likelihoods.</span></span><span class="sig-name descname"><span class="pre">negloglike_unif</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fprime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/likelihoods.html#negloglike_unif"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#likelihoods.negloglike_unif" title="Link to this definition"></a></dt>
<dd><p>Computes the negative log-likelihood under the assumption of an uncorrelated
Gaussian likelihood, where we have marginalised over the true x values,
assuming an infinite uniform prior on these.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">xobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The observed x values</p>
</dd>
<dt class="field-even">yobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The observed y values</p>
</dd>
<dt class="field-odd">xerr (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The error on the observed x values</p>
</dd>
<dt class="field-even">yerr (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The error on the observed y values</p>
</dd>
<dt class="field-odd">f (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>If we are fitting the function f(x), this is f(x) evaluated at
xobs</p>
</dd>
<dt class="field-even">fprime (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>If we are fitting the function f(x), this is df/dx
evaluated at xobs</p>
</dd>
<dt class="field-odd">sig (float)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The intrinsic scatter, which is added in quadrature with yerr</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="field-list simple">
<dt class="field-odd">neglogP (float)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The negative log-likelihood</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="likelihoods.negloglike_unif_mv">
<span class="sig-prename descclassname"><span class="pre">likelihoods.</span></span><span class="sig-name descname"><span class="pre">negloglike_unif_mv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/likelihoods.html#negloglike_unif_mv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#likelihoods.negloglike_unif_mv" title="Link to this definition"></a></dt>
<dd><p>Computes the negative log-likelihood under the assumption of a correlated
Gaussian likelihood (i.e. arbitrary covariance matrix), where we have
marginalised over the true x values, assuming an infinite uniform prior on these.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">xobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The observed x values</p>
</dd>
<dt class="field-even">yobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The observed y values</p>
</dd>
<dt class="field-odd">Sigma (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The covariance matrix giving the errors on the observed
(x, y) values</p>
</dd>
<dt class="field-even">f (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>If we are fitting the function f(x), this is f(x) evaluated
at xobs</p>
</dd>
<dt class="field-odd">G (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>If we are fitting the function f(x), this is
G_{ij} = df_i/dx_j evaluated at xobs</p>
</dd>
<dt class="field-even">sig (float)<span class="colon">:</span></dt>
<dd class="field-even"><p>The intrinsic scatter, which is added in quadrature with yerr</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="field-list simple">
<dt class="field-odd">neglogP (float)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The negative log-likelihood</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-mcmc">
<span id="mcmc"></span><h2>mcmc<a class="headerlink" href="#module-mcmc" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mcmc.Likelihood_GMM">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mcmc.</span></span><span class="sig-name descname"><span class="pre">Likelihood_GMM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fprime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_mu_gauss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_w_gauss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_weights</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mcmc.html#Likelihood_GMM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mcmc.Likelihood_GMM" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Distribution</span></code></p>
<p>Class to be used by <code class="docutils literal notranslate"><span class="pre">numpyro</span></code> to evaluate the log-likelihood under
the assumption of an uncorrelated Gaussian likelihood with a Gaussian
Mixture Model prior on the true x positions.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">xobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The observed x values</p>
</dd>
<dt class="field-even">yobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The observed y values</p>
</dd>
<dt class="field-odd">xerr (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The error on the observed x values</p>
</dd>
<dt class="field-even">yerr (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The error on the observed y values</p>
</dd>
<dt class="field-odd">f (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>If we are fitting the function f(x), this is f(x) evaluated
at xobs</p>
</dd>
<dt class="field-even">fprime (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>If we are fitting the function f(x), this is df/dx
evaluated at xobs</p>
</dd>
<dt class="field-odd">sig (float)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The intrinsic scatter, which is added in quadrature with yerr</p>
</dd>
<dt class="field-even">all_mu_gauss (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The mean of the Gaussians in the GMM prior on the
true x positions</p>
</dd>
<dt class="field-odd">all_w_gauss (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The standard deviation of the Gaussians in the GMM
prior on the true x positions</p>
</dd>
<dt class="field-even">all_weights (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The weights of the Gaussians in the GMM prior on the
true x positions</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mcmc.Likelihood_GMM.log_prob">
<span class="sig-name descname"><span class="pre">log_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mcmc.html#Likelihood_GMM.log_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mcmc.Likelihood_GMM.log_prob" title="Link to this definition"></a></dt>
<dd><p>Evaluates the log probability density for a batch of samples given by
<cite>value</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> – A batch of samples from the distribution.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array with shape <cite>value.shape[:-self.event_shape]</cite></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mcmc.Likelihood_GMM.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mcmc.html#Likelihood_GMM.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mcmc.Likelihood_GMM.sample" title="Link to this definition"></a></dt>
<dd><p>Returns a sample from the distribution having shape given by
<cite>sample_shape + batch_shape + event_shape</cite>. Note that when <cite>sample_shape</cite> is non-empty,
leading dimensions (of size <cite>sample_shape</cite>) of the returned sample will
be filled with iid draws from the distribution instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>jax.random.PRNGKey</em>) – the rng_key key to be used for the distribution.</p></li>
<li><p><strong>sample_shape</strong> (<em>tuple</em>) – the sample shape for the distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array of shape <cite>sample_shape + batch_shape + event_shape</cite></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mcmc.Likelihood_MNR">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mcmc.</span></span><span class="sig-name descname"><span class="pre">Likelihood_MNR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fprime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_gauss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_gauss</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mcmc.html#Likelihood_MNR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mcmc.Likelihood_MNR" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Distribution</span></code></p>
<p>Class to be used by <code class="docutils literal notranslate"><span class="pre">numpyro</span></code> to evaluate the log-likelihood under
the assumption of an uncorrelated Gaussian likelihood with a Gaussian
prior on the true x positions.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">xobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The observed x values</p>
</dd>
<dt class="field-even">yobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The observed y values</p>
</dd>
<dt class="field-odd">xerr (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The error on the observed x values</p>
</dd>
<dt class="field-even">yerr (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The error on the observed y values</p>
</dd>
<dt class="field-odd">f (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>If we are fitting the function f(x), this is f(x) evaluated
at xobs</p>
</dd>
<dt class="field-even">fprime (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>If we are fitting the function f(x), this is df/dx
evaluated at xobs</p>
</dd>
<dt class="field-odd">sig (float)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The intrinsic scatter, which is added in quadrature with yerr</p>
</dd>
<dt class="field-even">mu_gauss (float)<span class="colon">:</span></dt>
<dd class="field-even"><p>The mean of the Gaussian prior on the true x positions</p>
</dd>
<dt class="field-odd">w_gauss (float)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The standard deviation of the Gaussian prior on the true x
positions</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mcmc.Likelihood_MNR.log_prob">
<span class="sig-name descname"><span class="pre">log_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mcmc.html#Likelihood_MNR.log_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mcmc.Likelihood_MNR.log_prob" title="Link to this definition"></a></dt>
<dd><p>Evaluates the log probability density for a batch of samples given by
<cite>value</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> – A batch of samples from the distribution.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array with shape <cite>value.shape[:-self.event_shape]</cite></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mcmc.Likelihood_MNR.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mcmc.html#Likelihood_MNR.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mcmc.Likelihood_MNR.sample" title="Link to this definition"></a></dt>
<dd><p>Returns a sample from the distribution having shape given by
<cite>sample_shape + batch_shape + event_shape</cite>. Note that when <cite>sample_shape</cite> is non-empty,
leading dimensions (of size <cite>sample_shape</cite>) of the returned sample will
be filled with iid draws from the distribution instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>jax.random.PRNGKey</em>) – the rng_key key to be used for the distribution.</p></li>
<li><p><strong>sample_shape</strong> (<em>tuple</em>) – the sample shape for the distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array of shape <cite>sample_shape + batch_shape + event_shape</cite></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mcmc.Likelihood_MNR_MV">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mcmc.</span></span><span class="sig-name descname"><span class="pre">Likelihood_MNR_MV</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Sxx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Syy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Sxy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_gauss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_gauss</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mcmc.html#Likelihood_MNR_MV"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mcmc.Likelihood_MNR_MV" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Distribution</span></code></p>
<p>Class to be used by <code class="docutils literal notranslate"><span class="pre">numpyro</span></code> to evaluate the log-likelihood under
the assumption of a correlated Gaussian likelihood (i.e. arbitrary
covariance matrix), with a Gaussian prior on the true x positions.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">xobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The observed x values</p>
</dd>
<dt class="field-even">yobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The observed y values</p>
</dd>
<dt class="field-odd">Sxx (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The xx component of the covariance matrix giving the errors
on the observed (x, y) values</p>
</dd>
<dt class="field-even">Syy (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The yy component of the covariance matrix giving the errors
on the observed (x, y) values</p>
</dd>
<dt class="field-odd">Sxy (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The xy component of the covariance matrix giving the errors
on the observed (x, y) values</p>
</dd>
<dt class="field-even">f (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>If we are fitting the function f(x), this is f(x) evaluated at
xobs</p>
</dd>
<dt class="field-odd">G (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>If we are fitting the function f(x), this is
G_{ij} = df_i/dx_j evaluated at xobs</p>
</dd>
<dt class="field-even">sig (float)<span class="colon">:</span></dt>
<dd class="field-even"><p>The intrinsic scatter, which is added in quadrature with yerr</p>
</dd>
<dt class="field-odd">mu_gauss (float)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The mean of the Gaussian prior on the true x positions</p>
</dd>
<dt class="field-even">w_gauss (float)<span class="colon">:</span></dt>
<dd class="field-even"><p>The standard deviation of the Gaussian prior on the true x
positions</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mcmc.Likelihood_MNR_MV.log_prob">
<span class="sig-name descname"><span class="pre">log_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mcmc.html#Likelihood_MNR_MV.log_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mcmc.Likelihood_MNR_MV.log_prob" title="Link to this definition"></a></dt>
<dd><p>Evaluates the log probability density for a batch of samples given by
<cite>value</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> – A batch of samples from the distribution.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array with shape <cite>value.shape[:-self.event_shape]</cite></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mcmc.Likelihood_MNR_MV.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mcmc.html#Likelihood_MNR_MV.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mcmc.Likelihood_MNR_MV.sample" title="Link to this definition"></a></dt>
<dd><p>Returns a sample from the distribution having shape given by
<cite>sample_shape + batch_shape + event_shape</cite>. Note that when <cite>sample_shape</cite> is non-empty,
leading dimensions (of size <cite>sample_shape</cite>) of the returned sample will
be filled with iid draws from the distribution instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>jax.random.PRNGKey</em>) – the rng_key key to be used for the distribution.</p></li>
<li><p><strong>sample_shape</strong> (<em>tuple</em>) – the sample shape for the distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array of shape <cite>sample_shape + batch_shape + event_shape</cite></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mcmc.Likelihood_MNR_uplims">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mcmc.</span></span><span class="sig-name descname"><span class="pre">Likelihood_MNR_uplims</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_is_detected</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fprime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_gauss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_gauss</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mcmc.html#Likelihood_MNR_uplims"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mcmc.Likelihood_MNR_uplims" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Distribution</span></code></p>
<p>Class to be used by <code class="docutils literal notranslate"><span class="pre">numpyro</span></code> to evaluate the log-likelihood under
the assumption of an uncorrelated Gaussian likelihood with a Gaussian
prior on the true x positions, where some of the points are upper limits
(i.e. non-detections in y).</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">xobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The observed x values</p>
</dd>
<dt class="field-even">yobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The observed y values</p>
</dd>
<dt class="field-odd">y_is_detected (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>A boolean array of the same length as xobs and 
yobs, giving whether each point is a detection (True) or an upper limit 
(False)</p>
</dd>
<dt class="field-even">xerr (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The error on the observed x values</p>
</dd>
<dt class="field-odd">yerr (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The error on the observed y values</p>
</dd>
<dt class="field-even">f (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>If we are fitting the function f(x), this is f(x) evaluated
at xobs</p>
</dd>
<dt class="field-odd">fprime (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>If we are fitting the function f(x), this is df/dx
evaluated at xobs</p>
</dd>
<dt class="field-even">sig (float)<span class="colon">:</span></dt>
<dd class="field-even"><p>The intrinsic scatter, which is added in quadrature with yerr</p>
</dd>
<dt class="field-odd">mu_gauss (float)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The mean of the Gaussian prior on the true x positions</p>
</dd>
<dt class="field-even">w_gauss (float)<span class="colon">:</span></dt>
<dd class="field-even"><p>The standard deviation of the Gaussian prior on the true x
positions</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mcmc.Likelihood_MNR_uplims.log_prob">
<span class="sig-name descname"><span class="pre">log_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mcmc.html#Likelihood_MNR_uplims.log_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mcmc.Likelihood_MNR_uplims.log_prob" title="Link to this definition"></a></dt>
<dd><p>Evaluates the log probability density for a batch of samples given by
<cite>value</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> – A batch of samples from the distribution.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array with shape <cite>value.shape[:-self.event_shape]</cite></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mcmc.Likelihood_MNR_uplims.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mcmc.html#Likelihood_MNR_uplims.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mcmc.Likelihood_MNR_uplims.sample" title="Link to this definition"></a></dt>
<dd><p>Returns a sample from the distribution having shape given by
<cite>sample_shape + batch_shape + event_shape</cite>. Note that when <cite>sample_shape</cite> is non-empty,
leading dimensions (of size <cite>sample_shape</cite>) of the returned sample will
be filled with iid draws from the distribution instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>jax.random.PRNGKey</em>) – the rng_key key to be used for the distribution.</p></li>
<li><p><strong>sample_shape</strong> (<em>tuple</em>) – the sample shape for the distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array of shape <cite>sample_shape + batch_shape + event_shape</cite></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mcmc.Likelihood_prof">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mcmc.</span></span><span class="sig-name descname"><span class="pre">Likelihood_prof</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fprime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_logdet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mcmc.html#Likelihood_prof"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mcmc.Likelihood_prof" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Distribution</span></code></p>
<p>Class to be used by <code class="docutils literal notranslate"><span class="pre">numpyro</span></code> to evaluate the log-likelihood under
the assumption of an uncorrelated Gaussian likelihood, evaluated at
the maximum likelihood values of xtrue (the profile likelihood)</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">xobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The observed x values</p>
</dd>
<dt class="field-even">yobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The observed y values</p>
</dd>
<dt class="field-odd">xerr (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The error on the observed x values</p>
</dd>
<dt class="field-even">yerr (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The error on the observed y values</p>
</dd>
<dt class="field-odd">f (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>If we are fitting the function f(x), this is f(x) evaluated
at xobs</p>
</dd>
<dt class="field-even">fprime (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>If we are fitting the function f(x), this is df/dx
evaluated at xobs</p>
</dd>
<dt class="field-odd">sig (float)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The intrinsic scatter, which is added in quadrature with yerr</p>
</dd>
<dt class="field-even">include_logdet (bool, default=True)<span class="colon">:</span></dt>
<dd class="field-even"><p>Whether to include the normalisation term
in the likelihood proportional to log(det(S))</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mcmc.Likelihood_prof.log_prob">
<span class="sig-name descname"><span class="pre">log_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mcmc.html#Likelihood_prof.log_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mcmc.Likelihood_prof.log_prob" title="Link to this definition"></a></dt>
<dd><p>Evaluates the log probability density for a batch of samples given by
<cite>value</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> – A batch of samples from the distribution.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array with shape <cite>value.shape[:-self.event_shape]</cite></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mcmc.Likelihood_prof.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mcmc.html#Likelihood_prof.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mcmc.Likelihood_prof.sample" title="Link to this definition"></a></dt>
<dd><p>Returns a sample from the distribution having shape given by
<cite>sample_shape + batch_shape + event_shape</cite>. Note that when <cite>sample_shape</cite> is non-empty,
leading dimensions (of size <cite>sample_shape</cite>) of the returned sample will
be filled with iid draws from the distribution instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>jax.random.PRNGKey</em>) – the rng_key key to be used for the distribution.</p></li>
<li><p><strong>sample_shape</strong> (<em>tuple</em>) – the sample shape for the distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array of shape <cite>sample_shape + batch_shape + event_shape</cite></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mcmc.Likelihood_prof_MV">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mcmc.</span></span><span class="sig-name descname"><span class="pre">Likelihood_prof_MV</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Sxx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Syy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Sxy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_logdet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mcmc.html#Likelihood_prof_MV"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mcmc.Likelihood_prof_MV" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Distribution</span></code></p>
<p>Class to be used by <code class="docutils literal notranslate"><span class="pre">numpyro</span></code> to evaluate the log-likelihood under
the assumption of a correlated Gaussian likelihood (i.e. arbitrary covariance
matrix), evaluated at the maximum likelihood values of xtrue (the profile
likelihood)</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">xobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The observed x values</p>
</dd>
<dt class="field-even">yobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The observed y values</p>
</dd>
<dt class="field-odd">Sxx (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The xx component of the covariance matrix giving the errors
on the observed (x, y) values</p>
</dd>
<dt class="field-even">Syy (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The yy component of the covariance matrix giving the errors
on the observed (x, y) values</p>
</dd>
<dt class="field-odd">Sxy (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The xy component of the covariance matrix giving the errors
on the observed (x, y) values</p>
</dd>
<dt class="field-even">f (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>If we are fitting the function f(x), this is f(x) evaluated at
xobs</p>
</dd>
<dt class="field-odd">G (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>If we are fitting the function f(x), this is
G_{ij} = df_i/dx_j evaluated at xobs</p>
</dd>
<dt class="field-even">sig (float)<span class="colon">:</span></dt>
<dd class="field-even"><p>The intrinsic scatter, which is added in quadrature with yerr</p>
</dd>
<dt class="field-odd">include_logdet (bool, default=True)<span class="colon">:</span></dt>
<dd class="field-odd"><p>Whether to include the normalisation term
in the likelihood proportional to log(det(S))</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mcmc.Likelihood_prof_MV.log_prob">
<span class="sig-name descname"><span class="pre">log_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mcmc.html#Likelihood_prof_MV.log_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mcmc.Likelihood_prof_MV.log_prob" title="Link to this definition"></a></dt>
<dd><p>Evaluates the log probability density for a batch of samples given by
<cite>value</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> – A batch of samples from the distribution.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array with shape <cite>value.shape[:-self.event_shape]</cite></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mcmc.Likelihood_prof_MV.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mcmc.html#Likelihood_prof_MV.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mcmc.Likelihood_prof_MV.sample" title="Link to this definition"></a></dt>
<dd><p>Returns a sample from the distribution having shape given by
<cite>sample_shape + batch_shape + event_shape</cite>. Note that when <cite>sample_shape</cite> is non-empty,
leading dimensions (of size <cite>sample_shape</cite>) of the returned sample will
be filled with iid draws from the distribution instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>jax.random.PRNGKey</em>) – the rng_key key to be used for the distribution.</p></li>
<li><p><strong>sample_shape</strong> (<em>tuple</em>) – the sample shape for the distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array of shape <cite>sample_shape + batch_shape + event_shape</cite></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mcmc.Likelihood_unif">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mcmc.</span></span><span class="sig-name descname"><span class="pre">Likelihood_unif</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fprime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mcmc.html#Likelihood_unif"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mcmc.Likelihood_unif" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Distribution</span></code></p>
<p>Class to be used by <code class="docutils literal notranslate"><span class="pre">numpyro</span></code> to evaluate the log-likelihood under
the assumption of an uncorrelated Gaussian likelihood, where we have
marginalised over the true x values, assuming an infinite uniform
prior on these.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">xobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The observed x values</p>
</dd>
<dt class="field-even">yobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The observed y values</p>
</dd>
<dt class="field-odd">xerr (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The error on the observed x values</p>
</dd>
<dt class="field-even">yerr (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The error on the observed y values</p>
</dd>
<dt class="field-odd">f (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>If we are fitting the funciton f(x), this is f(x) evaluated
at xobs</p>
</dd>
<dt class="field-even">fprime (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>If we are fitting the funciton f(x), this is df/dx
evaluated at xobs</p>
</dd>
<dt class="field-odd">sig (float)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The intrinsic scatter, which is added in quadrature with yerr</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mcmc.Likelihood_unif.log_prob">
<span class="sig-name descname"><span class="pre">log_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mcmc.html#Likelihood_unif.log_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mcmc.Likelihood_unif.log_prob" title="Link to this definition"></a></dt>
<dd><p>Evaluates the log probability density for a batch of samples given by
<cite>value</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> – A batch of samples from the distribution.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array with shape <cite>value.shape[:-self.event_shape]</cite></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mcmc.Likelihood_unif.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mcmc.html#Likelihood_unif.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mcmc.Likelihood_unif.sample" title="Link to this definition"></a></dt>
<dd><p>Returns a sample from the distribution having shape given by
<cite>sample_shape + batch_shape + event_shape</cite>. Note that when <cite>sample_shape</cite> is non-empty,
leading dimensions (of size <cite>sample_shape</cite>) of the returned sample will
be filled with iid draws from the distribution instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>jax.random.PRNGKey</em>) – the rng_key key to be used for the distribution.</p></li>
<li><p><strong>sample_shape</strong> (<em>tuple</em>) – the sample shape for the distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array of shape <cite>sample_shape + batch_shape + event_shape</cite></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mcmc.Likelihood_unif_MV">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mcmc.</span></span><span class="sig-name descname"><span class="pre">Likelihood_unif_MV</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Sxx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Syy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Sxy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sig</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mcmc.html#Likelihood_unif_MV"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mcmc.Likelihood_unif_MV" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Distribution</span></code></p>
<p>Class to be used by <code class="docutils literal notranslate"><span class="pre">numpyro</span></code> to evaluate the log-likelihood under
the assumption of a correlated Gaussian likelihood (i.e. arbitrary covariance
matrix), where we have marginalised over the true x values, assuming an
infinite uniform prior on these.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">xobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The observed x values</p>
</dd>
<dt class="field-even">yobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The observed y values</p>
</dd>
<dt class="field-odd">Sxx (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The xx component of the covariance matrix giving the errors
on the observed (x, y) values</p>
</dd>
<dt class="field-even">Syy (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The yy component of the covariance matrix giving the errors
on the observed (x, y) values</p>
</dd>
<dt class="field-odd">Sxy (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The xy component of the covariance matrix giving the errors
on the observed (x, y) values</p>
</dd>
<dt class="field-even">f (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>If we are fitting the function f(x), this is f(x) evaluated at
xobs</p>
</dd>
<dt class="field-odd">G (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>If we are fitting the function f(x), this is
G_{ij} = df_i/dx_j evaluated at xobs</p>
</dd>
<dt class="field-even">sig (float)<span class="colon">:</span></dt>
<dd class="field-even"><p>The intrinsic scatter, which is added in quadrature with yerr</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mcmc.Likelihood_unif_MV.log_prob">
<span class="sig-name descname"><span class="pre">log_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mcmc.html#Likelihood_unif_MV.log_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mcmc.Likelihood_unif_MV.log_prob" title="Link to this definition"></a></dt>
<dd><p>Evaluates the log probability density for a batch of samples given by
<cite>value</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> – A batch of samples from the distribution.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array with shape <cite>value.shape[:-self.event_shape]</cite></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mcmc.Likelihood_unif_MV.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mcmc.html#Likelihood_unif_MV.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mcmc.Likelihood_unif_MV.sample" title="Link to this definition"></a></dt>
<dd><p>Returns a sample from the distribution having shape given by
<cite>sample_shape + batch_shape + event_shape</cite>. Note that when <cite>sample_shape</cite> is non-empty,
leading dimensions (of size <cite>sample_shape</cite>) of the returned sample will
be filled with iid draws from the distribution instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>jax.random.PRNGKey</em>) – the rng_key key to be used for the distribution.</p></li>
<li><p><strong>sample_shape</strong> (<em>tuple</em>) – the sample shape for the distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array of shape <cite>sample_shape + batch_shape + event_shape</cite></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mcmc.OrderedNormal">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mcmc.</span></span><span class="sig-name descname"><span class="pre">OrderedNormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">validate_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mcmc.html#OrderedNormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mcmc.OrderedNormal" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Distribution</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="mcmc.OrderedNormal.arg_constraints">
<span class="sig-name descname"><span class="pre">arg_constraints</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'loc':</span> <span class="pre">Real(),</span> <span class="pre">'scale':</span> <span class="pre">Positive(lower_bound=0.0)}</span></em><a class="headerlink" href="#mcmc.OrderedNormal.arg_constraints" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mcmc.OrderedNormal.cdf">
<span class="sig-name descname"><span class="pre">cdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mcmc.html#OrderedNormal.cdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mcmc.OrderedNormal.cdf" title="Link to this definition"></a></dt>
<dd><p>The cumulative distribution function of this distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> – samples from this distribution.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>output of the cumulative distribution function evaluated at <cite>value</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mcmc.OrderedNormal.icdf">
<span class="sig-name descname"><span class="pre">icdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mcmc.html#OrderedNormal.icdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mcmc.OrderedNormal.icdf" title="Link to this definition"></a></dt>
<dd><p>The inverse cumulative distribution function of this distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>q</strong> – quantile values, should belong to [0, 1].</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the samples whose cdf values equals to <cite>q</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mcmc.OrderedNormal.log_cdf">
<span class="sig-name descname"><span class="pre">log_cdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mcmc.html#OrderedNormal.log_cdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mcmc.OrderedNormal.log_cdf" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mcmc.OrderedNormal.log_prob">
<span class="sig-name descname"><span class="pre">log_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mcmc.OrderedNormal.log_prob" title="Link to this definition"></a></dt>
<dd><p>Evaluates the log probability density for a batch of samples given by
<cite>value</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>value</strong> – A batch of samples from the distribution.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array with shape <cite>value.shape[:-self.event_shape]</cite></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ArrayLike</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mcmc.OrderedNormal.mean">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mean</span></span><a class="headerlink" href="#mcmc.OrderedNormal.mean" title="Link to this definition"></a></dt>
<dd><p>Mean of the distribution.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mcmc.OrderedNormal.reparametrized_params">
<span class="sig-name descname"><span class="pre">reparametrized_params</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['loc',</span> <span class="pre">'scale']</span></em><a class="headerlink" href="#mcmc.OrderedNormal.reparametrized_params" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mcmc.OrderedNormal.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mcmc.html#OrderedNormal.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mcmc.OrderedNormal.sample" title="Link to this definition"></a></dt>
<dd><p>Returns a sample from the distribution having shape given by
<cite>sample_shape + batch_shape + event_shape</cite>. Note that when <cite>sample_shape</cite> is non-empty,
leading dimensions (of size <cite>sample_shape</cite>) of the returned sample will
be filled with iid draws from the distribution instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>jax.random.PRNGKey</em>) – the rng_key key to be used for the distribution.</p></li>
<li><p><strong>sample_shape</strong> (<em>tuple</em>) – the sample shape for the distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>an array of shape <cite>sample_shape + batch_shape + event_shape</cite></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mcmc.OrderedNormal.support">
<span class="sig-name descname"><span class="pre">support</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">OrderedVector()</span></em><a class="headerlink" href="#mcmc.OrderedNormal.support" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mcmc.OrderedNormal.variance">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">variance</span></span><a class="headerlink" href="#mcmc.OrderedNormal.variance" title="Link to this definition"></a></dt>
<dd><p>Variance of the distribution.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mcmc.compute_bias">
<span class="sig-prename descclassname"><span class="pre">mcmc.</span></span><span class="sig-name descname"><span class="pre">compute_bias</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mcmc.html#compute_bias"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mcmc.compute_bias" title="Link to this definition"></a></dt>
<dd><p>Computes the bias between MCMC samples and the true values of the parameters.
For the intrinsic scatter, a truncated normal distribution is first fitted to
the parameters since this parameter can only take positive values.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">samples (dict)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The MCMC samples, where the keys are the parameter names and
values are ndarrays of the samples</p>
</dd>
<dt class="field-even">truths (dict)<span class="colon">:</span></dt>
<dd class="field-even"><p>The true values of the parameters. The keys should be a subset
of the keys of samples</p>
</dd>
<dt class="field-odd">verbose (bool, default=True)<span class="colon">:</span></dt>
<dd class="field-odd"><p>Whether to print biases or not</p>
</dd>
</dl>
</dd>
<dt>Reurns:</dt><dd><p>: biases (dict): The biases in each of the parameters (units=number of sigmas)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mcmc.samples_to_array">
<span class="sig-prename descclassname"><span class="pre">mcmc.</span></span><span class="sig-name descname"><span class="pre">samples_to_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mcmc.html#samples_to_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mcmc.samples_to_array" title="Link to this definition"></a></dt>
<dd><p>Converts a dictionary of samples returned by <code class="docutils literal notranslate"><span class="pre">numpro</span></code> to a list of names
and an array of samples.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">samples (dict)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The MCMC samples, where the keys are the parameter names and
values are ndarrays of the samples</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="field-list simple">
<dt class="field-odd">labels (np.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The names of the sampled variables</p>
</dd>
<dt class="field-even">all_samples (np.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The sampled values for these variables.
Shape = (number of samples, number of parameters).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-plotting">
<span id="plotting"></span><h2>plotting<a class="headerlink" href="#module-plotting" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="plotting.posterior_predictive_plot">
<span class="sig-prename descclassname"><span class="pre">plotting.</span></span><span class="sig-name descname"><span class="pre">posterior_predictive_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_is_detected</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'$x$'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'$y$'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errorbar_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'alpha':</span> <span class="pre">1,</span> <span class="pre">'capsize':</span> <span class="pre">1,</span> <span class="pre">'color':</span> <span class="pre">'k',</span> <span class="pre">'elinewidth':</span> <span class="pre">0.5,</span> <span class="pre">'fmt':</span> <span class="pre">'.',</span> <span class="pre">'markersize':</span> <span class="pre">1,</span> <span class="pre">'zorder':</span> <span class="pre">10}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fgivenx_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plotting.html#posterior_predictive_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plotting.posterior_predictive_plot" title="Link to this definition"></a></dt>
<dd><p>Make the posterior predictive plot showing the 1, 2 and 3 sigma predictions
of the function given the inferred parameters and plot the observed points on
the same plot.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">reg (roxy.regressor.RoxyRegressor)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The regressor object used for the inference</p>
</dd>
<dt class="field-even">samples (dict)<span class="colon">:</span></dt>
<dd class="field-even"><p>The MCMC samples, where the keys are the parameter names and
values are ndarrays of the samples</p>
</dd>
<dt class="field-odd">xobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The observed x values</p>
</dd>
<dt class="field-even">yobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The observed y values</p>
</dd>
<dt class="field-odd">xerr (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The error on the observed x values</p>
</dd>
<dt class="field-even">yerr (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The error on the observed y values</p>
</dd>
<dt class="field-odd">y_is_detected (array-like, default=[])<span class="colon">:</span></dt>
<dd class="field-odd"><p>Boolean array of the same length as
yobs, where True indicates a detected point and False indicates an upper limit.</p>
</dd>
<dt class="field-even">savename (str, default=None)<span class="colon">:</span></dt>
<dd class="field-even"><p>If not None, save the figure to the file given
by this argument.</p>
</dd>
<dt class="field-odd">show (bool, default=True)<span class="colon">:</span></dt>
<dd class="field-odd"><p>If True, display the figure with plt.show()</p>
</dd>
<dt class="field-even">xlabel (str, default=’$x$’)<span class="colon">:</span></dt>
<dd class="field-even"><p>The label to use for the x axis</p>
</dd>
<dt class="field-odd">ylabel (str, default=’$x$’)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The label to use for the y axis</p>
</dd>
<dt class="field-even">errorbar_kwargs (dict)<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of kwargs to pass to plt.errorbar</p>
</dd>
<dt class="field-odd">fgivenx_kwargs (dict)<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary of kwargs to pass to fgivenx.plot_contours</p>
</dd>
<dt class="field-even">xscale (str, default=’linear’)<span class="colon">:</span></dt>
<dd class="field-even"><p>Scale to use for x axis (‘linear’ or ‘log’)</p>
</dd>
<dt class="field-odd">yscale (str, default=’linear’)<span class="colon">:</span></dt>
<dd class="field-odd"><p>Scale to use for y axis (‘linear’ or ‘log’)</p>
</dd>
<dt class="field-even">xlim (tuple, default=None)<span class="colon">:</span></dt>
<dd class="field-even"><p>If not None, set the x limits to this value</p>
</dd>
<dt class="field-odd">ylim (tuple, default=None)<span class="colon">:</span></dt>
<dd class="field-odd"><p>If not None, set the y limits to this value</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="field-list simple">
<dt class="field-odd">fig (matplotlib.figure.Figure)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The figure containing the posterior predictive
plot</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plotting.trace_plot">
<span class="sig-prename descclassname"><span class="pre">plotting.</span></span><span class="sig-name descname"><span class="pre">trace_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plotting.html#trace_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plotting.trace_plot" title="Link to this definition"></a></dt>
<dd><p>Plot the trace of the parameter values as a function of MCMC step</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">samples (dict)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The MCMC samples, where the keys are the parameter names and
values are ndarrays of the samples</p>
</dd>
<dt class="field-even">labels (list, default=None)<span class="colon">:</span></dt>
<dd class="field-even"><p>List of parameter labels ot use in the plot. If
None, then use the names given as keys in samples.</p>
</dd>
<dt class="field-odd">to_plot (list, default=’all’)<span class="colon">:</span></dt>
<dd class="field-odd"><p>If ‘all’, then use all parameters. If a list,
then only use the parameters given in that list</p>
</dd>
<dt class="field-even">savename (str, default=None)<span class="colon">:</span></dt>
<dd class="field-even"><p>If not None, save the figure to the file given by
this argument.</p>
</dd>
<dt class="field-odd">show (bool, default=True)<span class="colon">:</span></dt>
<dd class="field-odd"><p>If True, display the figure with plt.show()</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="plotting.triangle_plot">
<span class="sig-prename descclassname"><span class="pre">plotting.</span></span><span class="sig-name descname"><span class="pre">triangle_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'corner'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/plotting.html#triangle_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#plotting.triangle_plot" title="Link to this definition"></a></dt>
<dd><p>Plot the 1D and 2D posterior distributions of the parameters in a triangle plot.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">samples (dict)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The MCMC samples, where the keys are the parameter names and
values are ndarrays of the samples</p>
</dd>
<dt class="field-even">labels (dict, default=None)<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of parameter labels ot use in the plot.
If None, then use the names given as keys in samples.</p>
</dd>
<dt class="field-odd">to_plot (list, default=’all’)<span class="colon">:</span></dt>
<dd class="field-odd"><p>If ‘all’, then use all parameters. If a list,
then only use the parameters given in that list</p>
</dd>
<dt class="field-even">module (str, default=’corner’)<span class="colon">:</span></dt>
<dd class="field-even"><p>Which module to use to make the triangle plot
(‘corner’ or ‘getdist’ currently available)</p>
</dd>
<dt class="field-odd">param_prior (dict, default=None)<span class="colon">:</span></dt>
<dd class="field-odd"><p>If not None and using ‘getdist’, use this to
specify the range of the varibales to prevent undesirable smoothing effects.</p>
</dd>
<dt class="field-even">savename (str, default=None)<span class="colon">:</span></dt>
<dd class="field-even"><p>If not None, save the figure to the file given
by this argument.</p>
</dd>
<dt class="field-odd">show (bool, default=True)<span class="colon">:</span></dt>
<dd class="field-odd"><p>If True, display the figure with plt.show()</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-causality">
<span id="causality"></span><h2>causality<a class="headerlink" href="#module-causality" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="causality.assess_causality">
<span class="sig-prename descclassname"><span class="pre">causality.</span></span><span class="sig-name descname"><span class="pre">assess_causality</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fun</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fun_inv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yobs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">errors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_default</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_prior</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mnr'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">criterion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hsic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngauss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covmat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gmm_prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'hierarchical'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causality.html#assess_causality"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causality.assess_causality" title="Link to this definition"></a></dt>
<dd><p>Due to the asymmetry between x and y, this function assesses whether one
should fit y(x) or x(y) with the intrinsic scatter in the dependent variable.
The code runs both forward fits, i.e. y(x) and x(y), and the reverse fits,
where one uses the parameters obtained from the forward fit and uses the
inverse function. The correlation coefficient of the residuals
(normalised by the square root of the sum of the squares of the vertical
errors and the intrindic scatter) is then found, and the method which minimsies this
recommended as the best option. Plots of the fits and the residuals
are produced, since these can be more informative for some functions. The
recommended setup is indicated by a star in the plots.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">fun (callable)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The function, f, to be considered, y = f(x, theta).
The function must take two arguments, the first of which
is the independent variable, the second of which are the parameters (as an
array or list).</p>
</dd>
<dt class="field-even">fun_inv (callable)<span class="colon">:</span></dt>
<dd class="field-even"><p>If <cite>fun</cite> is y = f(x, theta), then this callable gives
x = f^{-1}(y, theta) for the same theta. The function must take two
arguments, the first corresponding to y and the second is theta.</p>
</dd>
<dt class="field-odd">xobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The observed x values</p>
</dd>
<dt class="field-even">yobs (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-even"><p>The observed y values</p>
</dd>
<dt class="field-odd">errors (jnp.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>If covmat=False, then this is [xerr, yerr], giving
the error on the observed x and y values. Otherwise, this is the
covariance matrix in the order (x, y)</p>
</dd>
<dt class="field-even">param_names (list)<span class="colon">:</span></dt>
<dd class="field-even"><p>The list of parameter names, in the order which they are
supplied to fun</p>
</dd>
<dt class="field-odd">param_default (list)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The default valus of the parameters</p>
</dd>
<dt class="field-even">param_prior (dict)<span class="colon">:</span></dt>
<dd class="field-even"><p>The prior range for each of the parameters. The prior is
assumed to be uniform in this range. If either entry is None in the prior,
then an infinite uniform prior is assumed.</p>
</dd>
<dt class="field-odd">method (str, default=’mnr’)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The name of the likelihood method to use
(‘mnr’, ‘gmm’, ‘unif’ or ‘prof’). See <code class="docutils literal notranslate"><span class="pre">roxy.likelihoods</span></code> for more
information</p>
</dd>
<dt class="field-even">criterion (str, default=’hsic’)<span class="colon">:</span></dt>
<dd class="field-even"><p>The method used to determine the weakest
correlation of the residuals. One of ‘hsic’, ‘spearman’ or ‘pearson’.</p>
</dd>
<dt class="field-odd">ngauss (int, default = 1)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of Gaussians to use in the GMM prior.
Only used if method=’gmm’</p>
</dd>
<dt class="field-even">covmat (bool, default=False)<span class="colon">:</span></dt>
<dd class="field-even"><p>This determines whether the errors argument
is [xerr, yerr] (False) or a covariance matrix (True).</p>
</dd>
<dt class="field-odd">gmm_prior (string, default=’hierarchical’)<span class="colon">:</span></dt>
<dd class="field-odd"><p>If method=’gmm’, this decides
what prior to put on the GMM componenents. If ‘uniform’, then the mean
and widths have a uniform prior, and if ‘hierarchical’ mu and w^2 have
a Normal and Inverse Gamma prior, respectively.</p>
</dd>
<dt class="field-even">savename (str, default=None)<span class="colon">:</span></dt>
<dd class="field-even"><p>If not None, save the figure to the file given by
this argument.</p>
</dd>
<dt class="field-odd">show (bool, default=True)<span class="colon">:</span></dt>
<dd class="field-odd"><p>If True, display the figure with plt.show()</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causality.compute_hsic">
<span class="sig-prename descclassname"><span class="pre">causality.</span></span><span class="sig-name descname"><span class="pre">compute_hsic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causality.html#compute_hsic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causality.compute_hsic" title="Link to this definition"></a></dt>
<dd><p>Python implementation of Hilbert Schmidt Independence Criterion
using a Gamma approximation. This code is largely taken from
<a class="reference external" href="https://github.com/amber0309/HSIC/tree/master">https://github.com/amber0309/HSIC/tree/master</a> (Shoubo (shoubo.sub AT gmail.com)
09/11/2016), with the new addition of the computation of the significance level.</p>
<p>Gretton, A., Fukumizu, K., Teo, C. H., Song, L., Scholkopf, B.,
&amp; Smola, A. J. (2007). A kernel statistical test of independence.
In Advances in neural information processing systems (pp. 585-592).</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="field-list simple">
<dt class="field-odd">X (np.ndarray)<span class="colon">:</span></dt>
<dd class="field-odd"><p>Numpy vector of dependent variable. The row gives the sample
and the column is the dimension.</p>
</dd>
<dt class="field-even">Y (np.ndarry)<span class="colon">:</span></dt>
<dd class="field-even"><p>Numpy vector of independent variable. The row gives the sample
and the column is the dimension.</p>
</dd>
<dt class="field-odd">alph (float)<span class="colon">:</span></dt>
<dd class="field-odd"><p>Worst significance level to consider. If the correlation is
stronger than this, then we don’t compute the correlation coefficient.</p>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><dl class="field-list simple">
<dt class="field-odd">testStat (float)<span class="colon">:</span></dt>
<dd class="field-odd"><p>The test statistic</p>
</dd>
<dt class="field-even">best_alph (float)<span class="colon">:</span></dt>
<dd class="field-even"><p>The significance of this result (if calculated)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tutorial.html" class="btn btn-neutral float-left" title="Tutorial" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Deaglan Bartlett and Harry Desmond.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>