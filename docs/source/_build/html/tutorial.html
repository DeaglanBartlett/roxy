

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tutorial &mdash; roxy 0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=d45e8c67"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API" href="api.html" />
    <link rel="prev" title="roxy" href="intro.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            roxy
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#defining-our-function">Defining our function</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mock-data-generation">Mock data generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#maximum-likelihood-estimation">Maximum likelihood estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#markov-chain-monte-carlo">Markov chain Monte Carlo</a></li>
<li class="toctree-l2"><a class="reference internal" href="#gaussian-mixture-models">Gaussian Mixture Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="#direction-of-causality">Direction of causality</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fitting-with-upper-limits">Fitting with Upper Limits</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reproducibility">Reproducibility</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">roxy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Tutorial</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/tutorial.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tutorial">
<h1>Tutorial<a class="headerlink" href="#tutorial" title="Link to this heading"></a></h1>
<p>In this tutorial we demonstrate how to fit a function to data using both a maximum-likelihood method, and by running a
MCMC using the <code class="docutils literal notranslate"><span class="pre">roxy</span></code> module. We then plot our results.</p>
<p>To start with, we call functions with the argument <code class="docutils literal notranslate"><span class="pre">method='mnr'</span></code>
as this is the simplest recommended likelihood for data with x and y errors and if you infer intrinsic scatter,
however this can be replaced with <code class="docutils literal notranslate"><span class="pre">method='unif'</span></code>
for an infinite uniform prior on the true x values, or <code class="docutils literal notranslate"><span class="pre">method='prof'</span></code> to use the profile likelihood.
In the presence of x-errors, the profile method is accurate in the absence of intrinsic scatter and the
unif method able to recover intrinsic scatter, however MNR is the only method that is approximately unbiased in all the regression parameters.
In summary, you should use the following likelihoods in the following situations:</p>
<ul class="simple">
<li><p>If you have <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> errors and DO wish to infer intrinsic scatter: use <code class="docutils literal notranslate"><span class="pre">method='mnr'</span></code>.</p></li>
<li><p>If you have <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> errors and DO NOT wish to infer intrinsic scatter: use <code class="docutils literal notranslate"><span class="pre">method='prof'</span></code>.</p></li>
<li><p>If you only have <span class="math notranslate nohighlight">\(y\)</span> errors: use <code class="docutils literal notranslate"><span class="pre">method='prof'</span></code> or <code class="docutils literal notranslate"><span class="pre">method='unif'</span></code> (they are identical in this case).</p></li>
</ul>
<p>Next, we show how to extend the MNR method to a sum of Gaussians using the argument
<code class="docutils literal notranslate"><span class="pre">method='gmm'</span></code>.
Given that the user will not know whether more than one Gaussian is appropriate a priori, we recommend
going through this section and applying these methods to your dataset. We leave this to the end of the
tutorial, however, so that you can get used to <code class="docutils literal notranslate"><span class="pre">roxy</span></code>’s features before worrying about the choice
of likelihood.</p>
<p>Please see the <a class="reference external" href="https://arxiv.org/abs/2309.00948">MNR paper</a> for more details on these likelihoods and their advantages/disadvantages.</p>
<p>We provide a note about the reproducibility of the tutorial results at the end of the tutorial.</p>
<section id="defining-our-function">
<h2>Defining our function<a class="headerlink" href="#defining-our-function" title="Link to this heading"></a></h2>
<p>We begin by defining a function which we wish to fit. Here we have <code class="docutils literal notranslate"><span class="pre">my_fun</span></code>, which is simply a straight line, but more complicated functions can be chosen. The function must take two arguments, the first being the independent variable, and the second are the parameters of interest.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">roxy.regressor</span><span class="w"> </span><span class="kn">import</span> <span class="n">RoxyRegressor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">roxy.plotting</span>

<span class="k">def</span><span class="w"> </span><span class="nf">my_fun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">theta</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>The optimisation and MCMC functionality of <code class="docutils literal notranslate"><span class="pre">roxy</span></code> can be accessed by the <code class="docutils literal notranslate"><span class="pre">roxy.regressor.RoxyRegressor</span></code> class, which we define here.
We must supply the names of each of the parameters of <code class="docutils literal notranslate"><span class="pre">my_fun</span></code>, as well as a fiducial point and the range of the priors (as a dictionary). We assume uniform priors for all parameters.
If you wish to set improper uniform priors without edges on an parameter, simply include <code class="docutils literal notranslate"><span class="pre">None</span></code> in one of the entries of the prior for that parameter.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">param_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">]</span>
<span class="n">theta0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
<span class="n">param_prior</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">:[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;sig&#39;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]}</span>

<span class="n">reg</span> <span class="o">=</span> <span class="n">RoxyRegressor</span><span class="p">(</span><span class="n">my_fun</span><span class="p">,</span> <span class="n">param_names</span><span class="p">,</span> <span class="n">theta0</span><span class="p">,</span> <span class="n">param_prior</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="mock-data-generation">
<h2>Mock data generation<a class="headerlink" href="#mock-data-generation" title="Link to this heading"></a></h2>
<p>Let us make some mock data from this function</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">nx</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">xerr</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">yerr</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">sig</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">xtrue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
<span class="n">ytrue</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">xtrue</span><span class="p">,</span> <span class="n">theta0</span><span class="p">)</span>
<span class="n">xobs</span> <span class="o">=</span> <span class="n">xtrue</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">xtrue</span><span class="p">))</span> <span class="o">*</span> <span class="n">xerr</span>
<span class="n">yobs</span> <span class="o">=</span> <span class="n">ytrue</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">xtrue</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">yerr</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">sig</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">plot_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;fmt&#39;</span><span class="p">:</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;markersize&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;zorder&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
                 <span class="s1">&#39;capsize&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;elinewidth&#39;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span>
<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">xobs</span><span class="p">,</span> <span class="n">yobs</span><span class="p">,</span> <span class="n">xerr</span><span class="o">=</span><span class="n">xerr</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">yerr</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x_{\rm obs}$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$y_{\rm obs}$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/data.png"><img alt="_images/data.png" src="_images/data.png" style="width: 480px;" />
</a>
</section>
<section id="maximum-likelihood-estimation">
<h2>Maximum likelihood estimation<a class="headerlink" href="#maximum-likelihood-estimation" title="Link to this heading"></a></h2>
<p>We begin by finding the maximum likelihood point, which is as simple as</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">res</span><span class="p">,</span> <span class="n">all_param_names</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">optimise</span><span class="p">(</span><span class="n">param_names</span><span class="p">,</span> <span class="n">xobs</span><span class="p">,</span> <span class="n">yobs</span><span class="p">,</span> <span class="p">[</span><span class="n">xerr</span><span class="p">,</span> <span class="n">yerr</span><span class="p">],</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;mnr&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Optimisation Results:</span>
<span class="go">A:      2.085973024368286</span>
<span class="go">B:      0.20573419332504272</span>
<span class="go">sig:    0.6321122646331787</span>
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">res</span></code> here is a <code class="docutils literal notranslate"><span class="pre">scipy.optimize._optimize.OptimizeResult</span></code> object, so you can use all the usual functionality this contains.</p>
<p>In this example, we optimised all the parameters. If, instead, we just wished to only find the gradient,
we could have used <code class="docutils literal notranslate"><span class="pre">['A']</span></code> instead of <code class="docutils literal notranslate"><span class="pre">param_names</span></code>, and then the intercept would be fixed to the default value in
<code class="docutils literal notranslate"><span class="pre">theta0</span></code> which we gave when initialising the regressor object (so in this case 0.5). We can also choose
to assume no intrinsic scatter by using the argument <code class="docutils literal notranslate"><span class="pre">infer_intrinsic=False</span></code> when calling <code class="docutils literal notranslate"><span class="pre">reg.optimise</span></code>.</p>
</section>
<section id="markov-chain-monte-carlo">
<h2>Markov chain Monte Carlo<a class="headerlink" href="#markov-chain-monte-carlo" title="Link to this heading"></a></h2>
<p>We will now run a MCMC. This uses the NUTS sampler from <code class="docutils literal notranslate"><span class="pre">numpyro</span></code> which is incredibly fast. We choose to use 700 warmup steps and take 5000 samples. We see that the result reports 3613.66 iterations per second, so this MCMC takes less than 2 seconds to run!</p>
<p>We print the parameter mean and median values, their standard deviations, the 5% and 95% bounds, the number of effective samples and the Gelman-Rubin statistic.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">nwarm</span><span class="p">,</span> <span class="n">nsamp</span> <span class="o">=</span> <span class="mi">700</span><span class="p">,</span> <span class="mi">5000</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">mcmc</span><span class="p">(</span><span class="n">param_names</span><span class="p">,</span> <span class="n">xobs</span><span class="p">,</span> <span class="n">yobs</span><span class="p">,</span> <span class="p">[</span><span class="n">xerr</span><span class="p">,</span> <span class="n">yerr</span><span class="p">],</span> <span class="n">nwarm</span><span class="p">,</span> <span class="n">nsamp</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;mnr&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Running MCMC</span>
<span class="go">sample: 100%|█████████████████████████████| 5700/5700 [00:02&lt;00:00, 2665.71it/s, 15 steps of size 3.42e-01. acc. prob=0.91]</span>

<span class="go">                mean       std    median      2.5%     97.5%     n_eff     r_hat</span>
<span class="go">         A      2.09      0.14      2.10      1.80      2.38   2221.65      1.00</span>
<span class="go">         B      0.19      0.43      0.18     -0.65      1.06   2116.94      1.00</span>
<span class="go">  mu_gauss      2.56      0.36      2.56      1.83      3.24   3358.24      1.00</span>
<span class="go">       sig      0.74      0.22      0.73      0.36      1.19   2870.27      1.00</span>
<span class="go">   w_gauss      1.63      0.29      1.59      1.11      2.18   3327.07      1.00</span>

<span class="go">Number of divergences: 0</span>
</pre></div>
</div>
<p>In this example we chose to use <code class="docutils literal notranslate"><span class="pre">method='mnr'</span></code>, but this can be any one of ‘mnr’, ‘gmm’, ‘unif’ or ‘prof’. See <code class="docutils literal notranslate"><span class="pre">roxy.likelihoods</span></code> and the MNR paper for more details of the choice of likelihood.</p>
<p>We now plot the results. The trace plot gives the sample value as a function of MCMC step, the triangle plot gives the one- and two-dimensional posterior distributions, and the posterior predictive plot gives the predicted function values at 1, 2 and 3 sigma confidence.
These plots make use of the <a class="reference external" href="https://www.arviz.org/en/latest/">arviz</a>, <a class="reference external" href="https://getdist.readthedocs.io/en/latest/">getdist</a> and <a class="reference external" href="https://fgivenx.readthedocs.io/en/latest/?badge=latest">fgivenx</a> modules, respectively. We also have functionality to produce triangle plots with the <a class="reference external" href="https://corner.readthedocs.io/en/latest/">corner</a> module (by replacing <code class="docutils literal notranslate"><span class="pre">module='getdist'</span></code> with <code class="docutils literal notranslate"><span class="pre">module='corner'</span></code> in <code class="docutils literal notranslate"><span class="pre">roxy.plotting.triangle_plot</span></code>).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">roxy</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">trace_plot</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">to_plot</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">roxy</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">triangle_plot</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">to_plot</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">module</span><span class="o">=</span><span class="s1">&#39;getdist&#39;</span><span class="p">,</span> <span class="n">param_prior</span><span class="o">=</span><span class="n">param_prior</span><span class="p">)</span>
<span class="n">roxy</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">posterior_predictive_plot</span><span class="p">(</span><span class="n">reg</span><span class="p">,</span> <span class="n">samples</span><span class="p">,</span> <span class="n">xobs</span><span class="p">,</span> <span class="n">yobs</span><span class="p">,</span> <span class="n">xerr</span><span class="p">,</span> <span class="n">yerr</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/trace.png"><img alt="_images/trace.png" src="_images/trace.png" style="width: 480px;" />
</a>
<a class="reference internal image-reference" href="_images/triangle.png"><img alt="_images/triangle.png" src="_images/triangle.png" style="width: 480px;" />
</a>
<a class="reference internal image-reference" href="_images/posterior_predictive.png"><img alt="_images/posterior_predictive.png" src="_images/posterior_predictive.png" style="width: 480px;" />
</a>
<p>Again, in this case we sampled all the parameters. If, instead, we just wished to just sample the gradient,
we could have passed <code class="docutils literal notranslate"><span class="pre">['A']</span></code> for <code class="docutils literal notranslate"><span class="pre">param_names</span></code>, and then the intercept would be fixed to the default value in
<code class="docutils literal notranslate"><span class="pre">theta0</span></code> which we gave when initialising the regressor object (so in this case 0.5). We can also choose
to assume no intrinsic scatter by using the argument <code class="docutils literal notranslate"><span class="pre">infer_intrinsic=False</span></code> when calling <code class="docutils literal notranslate"><span class="pre">reg.mcmc</span></code>.</p>
</section>
<section id="gaussian-mixture-models">
<h2>Gaussian Mixture Models<a class="headerlink" href="#gaussian-mixture-models" title="Link to this heading"></a></h2>
<p>We now consider a case where a single Gaussian is not sufficient to characterise the distribution of the true x values,
and so we resort to a Gaussian mixture model.
In the <a class="reference external" href="https://arxiv.org/abs/2309.00948">MNR paper</a> we study the effect of using multiple Gaussians and find that
it can sometimes reduce biases.
In this case we must fit the distribution</p>
<div class="math notranslate nohighlight">
\[P (x_{\rm t}) = \sum_{i=0}^{n_{\rm gauss}-1}{\frac{\nu_i}{\sqrt{2 \pi w_i^2}} \exp \left( - \frac{\left(x_{\rm t} - \mu_i \right)^2}{2 w_i^2} \right)},\]</div>
<p>where we have a set of weights, means a variances which we must fit. This can be achieved by using <code class="docutils literal notranslate"><span class="pre">method='gmm'</span></code> in <code class="docutils literal notranslate"><span class="pre">roxy</span></code> functions.</p>
<p>As an example, let us create some mock data from a two-component Gaussian mixture</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">nx</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="c1"># Draw the samples from a two Gaussian model</span>
<span class="n">true_weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">])</span>
<span class="n">true_means</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">10.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
<span class="n">true_w</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="n">which_gauss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">true_weights</span><span class="p">))</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">xtrue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">nx</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">true_means</span><span class="p">)):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="n">which_gauss</span> <span class="o">&gt;=</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">which_gauss</span> <span class="o">&lt;</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
    <span class="n">xtrue</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">true_means</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">true_w</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">m</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
<p>Plotting the distribution, we see this is highly non-Gaussian</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mpl</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;text.usetex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">xtrue</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xtrue</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">xtrue</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">300</span><span class="p">)</span>
<span class="n">ysum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="k">for</span> <span class="n">nu</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">true_weights</span><span class="p">,</span> <span class="n">true_means</span><span class="p">,</span> <span class="n">true_w</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">nu</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">w</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">w</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">ysum</span> <span class="o">+=</span> <span class="n">y</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ysum</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x_{\rm t}$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$p(x_{\rm t})$&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/gmm_distribution.png"><img alt="_images/gmm_distribution.png" src="_images/gmm_distribution.png" style="width: 480px;" />
</a>
<p>We then (as before) assume that these data given rise to y values which obey a straight line, so create mock data</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">roxy.regressor</span><span class="w"> </span><span class="kn">import</span> <span class="n">RoxyRegressor</span>

<span class="k">def</span><span class="w"> </span><span class="nf">my_fun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">theta</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">param_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">]</span>
<span class="n">theta0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
<span class="n">param_prior</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">:[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;sig&#39;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]}</span>
<span class="n">xerr</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">yerr</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">sig</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">reg</span> <span class="o">=</span> <span class="n">RoxyRegressor</span><span class="p">(</span><span class="n">my_fun</span><span class="p">,</span> <span class="n">param_names</span><span class="p">,</span> <span class="n">theta0</span><span class="p">,</span> <span class="n">param_prior</span><span class="p">)</span>

<span class="n">ytrue</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">xtrue</span><span class="p">,</span> <span class="n">theta0</span><span class="p">)</span>
<span class="n">xobs</span> <span class="o">=</span> <span class="n">xtrue</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">xtrue</span><span class="p">))</span> <span class="o">*</span> <span class="n">xerr</span>
<span class="n">yobs</span> <span class="o">=</span> <span class="n">ytrue</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">xtrue</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">yerr</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">sig</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Which we then plot</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plot_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;fmt&#39;</span><span class="p">:</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;markersize&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;zorder&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
         <span class="s1">&#39;capsize&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;elinewidth&#39;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span>
<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">xobs</span><span class="p">,</span> <span class="n">yobs</span><span class="p">,</span> <span class="n">xerr</span><span class="o">=</span><span class="n">xerr</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">yerr</span><span class="p">,</span> <span class="o">**</span><span class="n">plot_kwargs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$x_{\rm obs}$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$y_{\rm obs}$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/gmm_data.png"><img alt="_images/gmm_data.png" src="_images/gmm_data.png" style="width: 480px;" />
</a>
<p>Finally, we can run the same functions as before but with the <code class="docutils literal notranslate"><span class="pre">method='gmm'</span></code> argument to optimise or run a MCMC.
Note that we have to use the argument <code class="docutils literal notranslate"><span class="pre">ngauss=2</span></code> if we want to fit using two Gaussians.
We need to choose a prior for the parameters of the GMM, which is controlled by the argument <code class="docutils literal notranslate"><span class="pre">gmm_prior</span></code>.
If you use <code class="docutils literal notranslate"><span class="pre">gmm_prior='uniform'</span></code>, then a uniform prior is placed on the means and widths of the GMM componenets.
Instead if you use <code class="docutils literal notranslate"><span class="pre">gmm_prior='hierarchical'</span></code>, then the means and width have a Gaussian and Inverse Gamma prior, respectively. The hyper-parameters controlling these priors are drawn from Uniform or Inverse Gamma distributions (see the paper for more details).
This introduces
three further parameters which specify the priors, which we also have to sample.
For example, running</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">roxy.plotting</span>

<span class="n">nwarm</span><span class="p">,</span> <span class="n">nsamp</span> <span class="o">=</span> <span class="mi">700</span><span class="p">,</span> <span class="mi">5000</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">mcmc</span><span class="p">(</span><span class="n">param_names</span><span class="p">,</span> <span class="n">xobs</span><span class="p">,</span> <span class="n">yobs</span><span class="p">,</span> <span class="p">[</span><span class="n">xerr</span><span class="p">,</span> <span class="n">yerr</span><span class="p">],</span> <span class="n">nwarm</span><span class="p">,</span> <span class="n">nsamp</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;gmm&#39;</span><span class="p">,</span> <span class="n">ngauss</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">gmm_prior</span><span class="o">=</span><span class="s1">&#39;uniform&#39;</span><span class="p">)</span>
<span class="n">roxy</span><span class="o">.</span><span class="n">plotting</span><span class="o">.</span><span class="n">triangle_plot</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">to_plot</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">module</span><span class="o">=</span><span class="s1">&#39;getdist&#39;</span><span class="p">,</span> <span class="n">param_prior</span><span class="o">=</span><span class="n">param_prior</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>yields</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Running MCMC</span>
<span class="go">sample: 100%|██████████████████████████████| 5700/5700 [00:06&lt;00:00, 898.22it/s, 15 steps of size 3.22e-01. acc. prob=0.94]</span>

<span class="go">                 mean       std    median      2.5%     97.5%     n_eff     r_hat</span>
<span class="go">          A      2.00      0.00      2.00      1.99      2.01   4206.88      1.00</span>
<span class="go">          B      0.51      0.04      0.51      0.43      0.58   3916.77      1.00</span>
<span class="go">mu_gauss[0]    -10.00      0.08    -10.00    -10.17     -9.85   3809.84      1.00</span>
<span class="go">mu_gauss[1]     -0.22      0.27     -0.20     -0.78      0.28   3374.51      1.00</span>
<span class="go">        sig      0.49      0.02      0.49      0.45      0.54   4462.18      1.00</span>
<span class="go"> w_gauss[0]      1.86      0.06      1.86      1.73      1.99   3811.61      1.00</span>
<span class="go"> w_gauss[1]      3.26      0.21      3.25      2.87      3.68   3498.38      1.00</span>
<span class="go"> weights[0]      0.70      0.02      0.70      0.66      0.73   4183.47      1.00</span>
<span class="go"> weights[1]      0.30      0.02      0.30      0.27      0.34   4183.47      1.00</span>

<span class="go">Number of divergences: 0</span>
</pre></div>
</div>
<p>and</p>
<a class="reference internal image-reference" href="_images/gmm_corner.png"><img alt="_images/gmm_corner.png" src="_images/gmm_corner.png" style="width: 600px;" />
</a>
<p>A priori, we may not know how many Gaussians to use. For this case, we provide a function <code class="docutils literal notranslate"><span class="pre">find_best_gmm</span></code> as part of the
<code class="docutils literal notranslate"><span class="pre">roxy.RoxyRegressor</span></code> class, which can iterate through some number of Gaussians, and compare the best through either the
AIC or BIC. For example, with these data, we can check to see whether we should use 1, 2 or 3 Gaussians</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">max_ngauss</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">reg</span><span class="o">.</span><span class="n">find_best_gmm</span><span class="p">(</span><span class="n">param_names</span><span class="p">,</span> <span class="n">xobs</span><span class="p">,</span> <span class="n">yobs</span><span class="p">,</span> <span class="n">xerr</span><span class="p">,</span> <span class="n">yerr</span><span class="p">,</span> <span class="n">max_ngauss</span><span class="p">,</span> <span class="n">best_metric</span><span class="o">=</span><span class="s1">&#39;BIC&#39;</span><span class="p">,</span> <span class="n">nwarm</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">nsamp</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">gmm_prior</span><span class="o">=</span><span class="s1">&#39;uniform&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>which gives (alongside some other output)</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Best ngauss according to BIC: 2</span>
<span class="go">1 555.8955078125</span>
<span class="go">2 0.0</span>
<span class="go">3 22.76904296875</span>
</pre></div>
</div>
<p>so, indeed, 2 Gaussians are preferred.</p>
<p>Note that we specified <code class="docutils literal notranslate"><span class="pre">nwarm</span></code> and <code class="docutils literal notranslate"><span class="pre">nsamp</span></code>. This is because we run a short MCMC at each parameter optimisation step
to give us a better initial starting point to run our optimiser. These values can be set to small numbers, as we do not
care about sampling the distribution well, but only getting a good initial guess.</p>
</section>
<section id="direction-of-causality">
<h2>Direction of causality<a class="headerlink" href="#direction-of-causality" title="Link to this heading"></a></h2>
<p>A property of the likelihoods used in <code class="docutils literal notranslate"><span class="pre">roxy</span></code> is asymmetry with respect to <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>,
so that the regression results depend on which variable is considered independent.
The result is most reliable when the direction of regression matches the direction of causality in the system under investigation.
This may be assessed by treating the scatter of the points around the best-fit line as an additive noise model.
In this case, the independent variable may be identified as the one that has least correlation with the residuals of the fit.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">roxy</span></code> function <code class="docutils literal notranslate"><span class="pre">roxy.causality.assess_causality</span></code> fits both the forward and inverse relations to the dataset,
produces plots of the data in both directions with both regression models overlaid and the corresponding normalised
residuals plotted against the independent variable, and calculates a correlation coefficient (Spearman, Pearson or HSIC).
The default choice is HSIC (Hilbert-Schmidt Independence Criterion) because this was used in the original paper
<a class="reference external" href="https://papers.nips.cc/paper_files/paper/2008/hash/f7664060cc52bc6f3d620bcedc94a4b6-Abstract.html">(Hoyer et al. 2008)</a>
introducing the additive noise model.
This method has been shown to be highly reliable
<a class="reference external" href="https://arxiv.org/abs/1412.3773">(Mooij et al. 2014)</a>.
From these coefficients <code class="docutils literal notranslate"><span class="pre">roxy</span></code> makes a recommendation as to which variable to treat as independent and which dependent
(which may require renaming the input arrays before performing the regression).
We normalise the residuals by the square root of the
sum of the dependent variable’s error squared and the intrinsic scatter squared
so that the results are not dominated by points with large uncertainties.</p>
<p>For example, let us create some mock data in the case where we know that <span class="math notranslate nohighlight">\(y\)</span> is the dependent variable.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">roxy.regressor</span><span class="w"> </span><span class="kn">import</span> <span class="n">RoxyRegressor</span>

<span class="k">def</span><span class="w"> </span><span class="nf">my_fun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">theta</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">param_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">]</span>
<span class="n">theta0</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="n">param_prior</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">:[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;sig&#39;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]}</span>

<span class="n">reg</span> <span class="o">=</span> <span class="n">RoxyRegressor</span><span class="p">(</span><span class="n">my_fun</span><span class="p">,</span> <span class="n">param_names</span><span class="p">,</span> <span class="n">theta0</span><span class="p">,</span> <span class="n">param_prior</span><span class="p">)</span>

<span class="n">nx</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">xerr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
<span class="n">yerr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
<span class="n">xerr</span><span class="p">[</span><span class="n">xerr</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
<span class="n">yerr</span><span class="p">[</span><span class="n">yerr</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
<span class="n">sig</span> <span class="o">=</span> <span class="mf">3.0</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">xtrue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
<span class="n">ytrue</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">xtrue</span><span class="p">,</span> <span class="n">theta0</span><span class="p">)</span>
<span class="n">xobs</span> <span class="o">=</span> <span class="n">xtrue</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">xtrue</span><span class="p">))</span> <span class="o">*</span> <span class="n">xerr</span>
<span class="n">yobs</span> <span class="o">=</span> <span class="n">ytrue</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">xtrue</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">yerr</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">sig</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>To do the inverse fits, we need to define the inverse function. I.e. if <code class="docutils literal notranslate"><span class="pre">my_fun</span></code> above gives
<span class="math notranslate nohighlight">\(y = f(x, \theta)\)</span>, then we need the function <span class="math notranslate nohighlight">\(x = g(y, \theta)\)</span>, which for this case is</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">fun_inv</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">y</span> <span class="o">/</span> <span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">theta</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>We now call the function <code class="docutils literal notranslate"><span class="pre">roxy.causality.assess_causality</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">roxy.causality</span>
<span class="n">roxy</span><span class="o">.</span><span class="n">causality</span><span class="o">.</span><span class="n">assess_causality</span><span class="p">(</span><span class="n">my_fun</span><span class="p">,</span> <span class="n">fun_inv</span><span class="p">,</span> <span class="n">xobs</span><span class="p">,</span> <span class="n">yobs</span><span class="p">,</span> <span class="p">[</span><span class="n">xerr</span><span class="p">,</span> <span class="n">yerr</span><span class="p">],</span>
                                <span class="n">param_names</span><span class="p">,</span> <span class="n">theta0</span><span class="p">,</span> <span class="n">param_prior</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;mnr&#39;</span><span class="p">,</span>
                                <span class="n">criterion</span><span class="o">=</span><span class="s1">&#39;hsic&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>which gives the output</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Fitting y vs x</span>

<span class="go">Optimisation Results:</span>
<span class="go">A:      0.38329729437828064</span>
<span class="go">B:      0.6116797924041748</span>
<span class="go">sig:    2.8931143283843994</span>
<span class="go">mu_gauss:       14.385257720947266</span>
<span class="go">w_gauss:        8.616861343383789</span>

<span class="go">Fitting x vs y</span>

<span class="go">Optimisation Results:</span>
<span class="go">A:      1.9811209440231323</span>
<span class="go">B:      2.0</span>
<span class="go">sig:    3.0</span>
<span class="go">mu_gauss:       6.214134216308594</span>
<span class="go">w_gauss:        4.011857032775879</span>

<span class="go">y(x) forward HSIC: 0.159, (p=0.898)</span>

<span class="go">y(x) inverse HSIC: 0.655, (p=0.03)</span>

<span class="go">x(y) forward HSIC: 0.772, (p=0.005)</span>

<span class="go">x(y) inverse HSIC: 2.342, (p&lt;0.001)</span>

<span class="go">Recommended direction: y(x)</span>
</pre></div>
</div>
<p>and the figure</p>
<a class="reference internal image-reference" href="_images/causality.png"><img alt="_images/causality.png" src="_images/causality.png" style="width: 700px;" />
</a>
<p>From the correlation coefficients, we see that fitting <span class="math notranslate nohighlight">\(y(x)\)</span> in the forward
direction is the best option, and thus in the plot this option is starred (and is correct).
We caution however that the correlations may be non-monotonic and/or nonlinear, and therefore
recommend picking the regression direction that visually produces the lowest correlation in the residuals,
only resorting to the quantitative correlation coefficients in close cases.
We also caution that the test is more accurate the larger <span class="math notranslate nohighlight">\(\sigma_{\rm int}^2 + \sigma_y^2\)</span> is relative to <span class="math notranslate nohighlight">\(\sigma_x^2\)</span>,
and may be unreliable in the opposite regime.</p>
</section>
<section id="fitting-with-upper-limits">
<h2>Fitting with Upper Limits<a class="headerlink" href="#fitting-with-upper-limits" title="Link to this heading"></a></h2>
<p>We now consider the case where some of our data points are upper limits (i.e., censored data).
This happens, for example, when an instrument has a certain detection threshold, and any
measurement below that threshold is not detected and is instead reported as an upper limit.
The <code class="docutils literal notranslate"><span class="pre">roxy</span></code> module can handle upper limits in the independent variable (<code class="docutils literal notranslate"><span class="pre">yobs</span></code>) by passing the
argument <code class="docutils literal notranslate"><span class="pre">y_is_detected</span></code>. This is an array of booleans of the same length as <code class="docutils literal notranslate"><span class="pre">yobs</span></code>,
indicating whether each data point is detected (True) or an upper limit (False).
By default, all data points are assumed to be detected.
So far, we have only implemented this functionality for the MNR likelihood, so you must use
<code class="docutils literal notranslate"><span class="pre">method='mnr'</span></code> when calling the relevant functions.
In this case, the likelihood is modified to account for the censored data points.</p>
<p>An example is given below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">roxy.regressor</span><span class="w"> </span><span class="kn">import</span> <span class="n">RoxyRegressor</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">roxy.plotting</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plotting</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">my_fun</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">theta</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">param_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">]</span>
<span class="n">theta0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
<span class="n">param_prior</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">:[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;sig&#39;</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]}</span>

<span class="n">reg</span> <span class="o">=</span> <span class="n">RoxyRegressor</span><span class="p">(</span><span class="n">my_fun</span><span class="p">,</span> <span class="n">param_names</span><span class="p">,</span> <span class="n">theta0</span><span class="p">,</span> <span class="n">param_prior</span><span class="p">)</span>

<span class="n">nx</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">xerr</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">yerr</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">sig</span> <span class="o">=</span> <span class="mf">0.8</span>

<span class="n">xtrue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span>
<span class="n">ytrue</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="n">xtrue</span><span class="p">,</span> <span class="n">theta0</span><span class="p">)</span>

<span class="n">xobs</span> <span class="o">=</span> <span class="n">xtrue</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">xtrue</span><span class="p">))</span> <span class="o">*</span> <span class="n">xerr</span>
<span class="n">yobs</span> <span class="o">=</span> <span class="n">ytrue</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">xtrue</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">yerr</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">sig</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">det_threshold</span> <span class="o">=</span> <span class="mf">4.0</span>

<span class="c1"># mask = True where value is an *upper limit* / censored</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">yobs</span> <span class="o">&lt;=</span> <span class="n">det_threshold</span>

<span class="c1"># Replace censored yobs with the threshold (no in-place assignment)</span>
<span class="n">yobs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">det_threshold</span><span class="p">,</span> <span class="n">yobs</span><span class="p">)</span>

<span class="c1"># Detection flag: True if detected, False if upper-limit</span>
<span class="n">y_is_detected</span> <span class="o">=</span> <span class="o">~</span><span class="n">mask</span>

<span class="n">nwarm</span><span class="p">,</span> <span class="n">nsamp</span> <span class="o">=</span> <span class="mi">700</span><span class="p">,</span> <span class="mi">5000</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">mcmc</span><span class="p">(</span><span class="n">param_names</span><span class="p">,</span> <span class="n">xobs</span><span class="p">,</span> <span class="n">yobs</span><span class="p">,</span> <span class="p">[</span><span class="n">xerr</span><span class="p">,</span> <span class="n">yerr</span><span class="p">],</span> <span class="n">nwarm</span><span class="p">,</span> <span class="n">nsamp</span><span class="p">,</span>
                   <span class="n">method</span><span class="o">=</span><span class="s1">&#39;mnr&#39;</span><span class="p">,</span> <span class="n">y_is_detected</span><span class="o">=</span><span class="n">y_is_detected</span><span class="p">)</span>

<span class="n">plotting</span><span class="o">.</span><span class="n">trace_plot</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">to_plot</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">triangle_plot</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">to_plot</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">module</span><span class="o">=</span><span class="s1">&#39;getdist&#39;</span><span class="p">,</span> <span class="n">param_prior</span><span class="o">=</span><span class="n">param_prior</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Optimisation Results:</span>
<span class="go">A:      2.3444559574127197</span>
<span class="go">B:      -0.4485660791397095</span>
<span class="go">sig:    0.5253092646598816</span>
<span class="go">mu_gauss:       2.514636516571045</span>
<span class="go">w_gauss:        1.4311318397521973</span>

<span class="go">Running MCMC</span>
<span class="go">sample: 100%|██████████| 5700/5700 [00:07&lt;00:00, 715.31it/s, 31 steps of size 2.02e-01. acc. prob=0.91]</span>

<span class="go">                mean       std    median      2.5%     97.5%     n_eff     r_hat</span>
<span class="go">         A      2.35      0.14      2.35      2.10      2.63   2291.15      1.00</span>
<span class="go">         B     -0.48      0.48     -0.47     -1.43      0.43   2309.41      1.00</span>
<span class="go">  mu_gauss      2.51      0.20      2.52      2.11      2.90   3283.05      1.00</span>
<span class="go">       sig      0.57      0.15      0.57      0.28      0.86   3340.44      1.00</span>
<span class="go">   w_gauss      1.48      0.15      1.47      1.19      1.77   4024.05      1.00</span>

<span class="go">Number of divergences: 0</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/uplims_trace_plot.png"><img alt="_images/uplims_trace_plot.png" src="_images/uplims_trace_plot.png" style="width: 700px;" />
</a>
<a class="reference internal image-reference" href="_images/uplims_triangle_plot.png"><img alt="_images/uplims_triangle_plot.png" src="_images/uplims_triangle_plot.png" style="width: 700px;" />
</a>
</section>
<section id="reproducibility">
<h2>Reproducibility<a class="headerlink" href="#reproducibility" title="Link to this heading"></a></h2>
<p>This tutorial was run using MacOS with a M2 chip. We have found that the results reported can
marginally vary between architectures or between package versions of the dependenices of <code class="docutils literal notranslate"><span class="pre">roxy</span></code>.
Such changes are small, e.g. the fourth decimal place of an optimisation result may differ,
so if there are minor differences between the above results and what you find, there is no reason
to be concerned! For completeness, below we give the exact conda environment we used to obtain these
results.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">roxy_env</span>
<span class="nt">channels</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">conda-forge</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">defaults</span>
<span class="nt">dependencies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bzip2=1.0.8=h0d85af4_4</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">c-ares=1.20.1=h10d778d_0</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ca-certificates=2023.7.22=h8857fd0_0</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">importlib-metadata=6.8.0=pyha770c72_0</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">importlib_metadata=6.8.0=hd8ed1ab_0</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">jax=0.4.16=pyhd8ed1ab_0</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">jaxlib=0.4.14=cpu_py311hb9eea52_1</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">libabseil=20230802.1=cxx17_h048a20a_0</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">libblas=3.9.0=18_osx64_openblas</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">libcblas=3.9.0=18_osx64_openblas</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">libcxx=16.0.6=hd57cbcb_0</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">libexpat=2.5.0=hf0c8a7f_1</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">libffi=3.4.2=h0d85af4_5</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">libgfortran=5.0.0=13_2_0_h97931a8_1</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">libgfortran5=13.2.0=h2873a65_1</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">libgrpc=1.58.1=hecc90c7_2</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">liblapack=3.9.0=18_osx64_openblas</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">libopenblas=0.3.24=openmp_h48a4ad5_0</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">libprotobuf=4.24.3=he0c2237_1</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">libre2-11=2023.06.02=h4694dbf_0</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">libsqlite=3.43.2=h92b6c6a_0</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">libzlib=1.2.13=h8a1eda9_5</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">llvm-openmp=17.0.2=hff08bdf_0</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ml_dtypes=0.3.1=py311h1eadf79_1</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ncurses=6.4=hf0c8a7f_0</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">numpy=1.26.0=py311hc44ba51_0</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">openssl=3.1.3=h8a1eda9_0</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">opt-einsum=3.3.0=hd8ed1ab_2</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">opt_einsum=3.3.0=pyhc1e730c_2</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pip=23.2.1=pyhd8ed1ab_0</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python=3.11.4=h30d4d87_0_cpython</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python_abi=3.11=4_cp311</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">re2=2023.06.02=hd34609a_0</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">readline=8.2=h9e318b2_1</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">scipy=1.11.3=py311h16c3c4d_1</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">setuptools=68.2.2=pyhd8ed1ab_0</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tk=8.6.13=hef22860_0</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">wheel=0.41.2=pyhd8ed1ab_0</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">xz=5.2.6=h775f41a_0</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">zipp=3.17.0=pyhd8ed1ab_0</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">pip</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">alabaster==0.7.13</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">arviz==0.16.1</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">babel==2.13.0</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">certifi==2023.7.22</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">charset-normalizer==3.3.0</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">contourpy==1.1.1</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">corner==2.2.2</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cycler==0.12.1</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">docutils==0.18.1</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fgivenx==2.4.2</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fonttools==4.43.1</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">getdist==1.4.5</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">h5netcdf==1.2.0</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">h5py==3.10.0</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">idna==3.4</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">imagesize==1.4.1</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">jaxopt==0.8.1</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">jinja2==3.1.2</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">joblib==1.3.2</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">kiwisolver==1.4.5</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">markdown-it-py==3.0.0</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">markupsafe==2.1.3</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">matplotlib==3.8.0</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mdit-py-plugins==0.4.0</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mdurl==0.1.2</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">multipledispatch==1.0.0</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myst-parser==2.0.0</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">numpyro==0.13.2</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">packaging==23.2</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pandas==2.1.1</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pillow==10.0.1</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">prettytable==3.9.0</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pygments==2.16.1</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pyparsing==3.1.1</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python-dateutil==2.8.2</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pytz==2023.3.post1</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pyyaml==6.0.1</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">requests==2.31.0</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">scikit-learn==1.3.1</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">six==1.16.0</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">snowballstemmer==2.2.0</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sphinx==7.2.6</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sphinx-rtd-theme==1.3.0</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sphinxcontrib-applehelp==1.0.7</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sphinxcontrib-devhelp==1.0.5</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sphinxcontrib-htmlhelp==2.0.4</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sphinxcontrib-jquery==4.1</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sphinxcontrib-jsmath==1.0.1</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sphinxcontrib-qthelp==1.0.6</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sphinxcontrib-serializinghtml==1.1.9</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">threadpoolctl==3.2.0</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tqdm==4.66.1</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">typing-extensions==4.8.0</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tzdata==2023.3</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">urllib3==2.0.6</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">wcwidth==0.2.8</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">xarray==2023.9.0</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">xarray-einstats==0.6.0</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="intro.html" class="btn btn-neutral float-left" title="roxy" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="api.html" class="btn btn-neutral float-right" title="API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Deaglan Bartlett and Harry Desmond.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>